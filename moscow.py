# coding=UTF-8

import pandas as pd
import re
import spacy

nlp = spacy.load("ru_core_news_sm")

unusable_dict_functions = {"издательство": ["Другое"], "Притча": ["Религиозные объекты"], "Церковь": ["Религиозные объекты"], "Мужской монастырь": ["Религиозные объекты"], "Монастырь": ["Религиозные объекты"], "Храм": ["Религиозные объекты"], "Часовня": ["Религиозные объекты"], "Собор": ["Религиозные объекты"], "Мечеть": ["Религиозные объекты"], "Колокольня": ["Религиозные объекты"], "Трапезная": ["Религиозные объекты", "Объекты общепита" ], "Дом священника": ["Религиозные объекты"], "Синагога": ["Религиозные объекты"], "Аббатство (католический монастырь)": ["Религиозные объекты"], "Базилика": ["Религиозные объекты"], "Коллегиальная церковь": ["Религиозные объекты"], "Пристройка для крещения": ["Религиозные объекты"], "Религиозное объединение": ["Религиозные объекты"], "Комната для монахов": ["Религиозные объекты"], "Богадельня": ["Религиозные объекты"], "Звонница": ["Религиозные объекты"], "община": ["Религиозные объекты"], "Усыпальница": ["Религиозные объекты"], "Магазин": ["Объекты обслуживания"], "Гастроном": ["Объекты обслуживания"], "Бакалея": ["Объекты обслуживания"], "Рынок": ["Объекты обслуживания"], "Лавка": ["Объекты обслуживания"], "Киоск": ["Объекты обслуживания"], "Павильон": ["Объекты обслуживания"], "Пекарня": ["Объекты обслуживания"], "Булочная": ["Объекты обслуживания"], "Аптека": ["Объекты обслуживания"], "Рыбный магазин": ["Объекты обслуживания"], "Молочные продукты": ["Объекты обслуживания"], "Универмаг": ["Объекты обслуживания"], "Ряд магазинов": ["Объекты обслуживания"], "пассаж": ["Объекты обслуживания"], "Торговые ряды": ["Объекты обслуживания"], "Почта": ["Объекты обслуживания"], "скоропечатня": ["Объекты обслуживания"], "Телефонный центр": ["Объекты обслуживания"], "Типография": ["Объекты обслуживания"], "отделение": ["Объекты обслуживания"], "Почтамт": ["Объекты обслуживания"], "Телеграф": ["Объекты обслуживания"], "Общественный туалет": ["Объекты обслуживания"], "баня": ["Объекты обслуживания"], "Академия": ["Объекты науки и образования"], "Колледж": ["Объекты науки и образования"], "Школа": ["Объекты науки и образования"], "Институт": ["Объекты науки и образования"], "Гимназия": ["Объекты науки и образования"], "Университет": ["Объекты науки и образования"], "Лицей": ["Объекты науки и образования"], "Консерватория": ["Объекты науки и образования"], "Детский сад": ["Объекты науки и образования"], "Обсерватория": ["Объекты науки и образования"], "Лаборатория": ["Объекты науки и образования"], "Медицинская школа": ["Объекты науки и образования"], "Техникум": ["Объекты науки и образования"], "Училище": ["Объекты науки и образования"], "Сельскохозяйственная академия": ["Объекты науки и образования"], "Бар": ["Объекты общепита"], "Пивная": ["Объекты общепита"], "Кафе": ["Объекты общепита"], "Ресторан": ["Объекты общепита"], "Столовая": ["Объекты общепита"], "Трактир": ["Объекты общепита"], "Кабак": ["Объекты общепита"], "Кинотеатр": ["Объекты культуры"], "конференцзала": ["Объекты культуры"], "Галерея": ["Объекты культуры"], "Театр": ["Объекты культуры"], "Центр культуры": ["Объекты культуры"], "Дом культуры": ["Объекты культуры"], "Концертный зал": ["Объекты культуры"], "Клуб": ["Объекты культуры"], "Кабаре": ["Объекты культуры"], "Казино": ["Объекты культуры"], "Цирк": ["Объекты культуры"], "фойе": ["Объекты культуры"], "электротеатр": ["Объекты культуры"], "манеж": ["Объекты культуры"], "филармония": ["Объекты культуры"], "планетарий": ["Объекты культуры"], "Музей": ["Объекты культуры"], "Архив": ["Объекты культуры"], "Библиотека": ["Объекты культуры"], "музей-панорама": ["Объекты культуры"], "панорама": ["Объекты культуры"], "Гостиница": ["Гостиницы"], "Отель": ["Гостиницы"], "Номер": ["Гостиницы"], "Министерство": ["Административные объекты"], "Корпус": ["Административные объекты"], "Дворец": ["Административные объекты"], "Управление": ["Административные объекты"], "общество": ["Административные объекты"], "Кремль": ["Административные объекты"], "Ратуша": ["Административные объекты"], "Кригскомиссариат": ["Административные объекты"], "Таможня": ["Административные объекты"], "полицейская часть": ["Административные объекты"], "контора": ["Административные объекты"], "совет": ["Административные объекты"], "канцелярия": ["Административные объекты"], "Сенат": ["Административные объекты"], "имение": ["Жилые дома"], "купец": ["Жилые дома"], "поэт": ["Жилые дома"], "постройка": ["Жилые дома"], "дома": ["Жилые дома"], "палаты": ["Жилые дома"], "усадьба": ["Жилые дома"], "замок": ["Жилые дома"], "дача": ["Жилые дома"], "флигель": ["Жилые дома"], "вилла": ["Жилые дома"], "двор": ["Жилые дома"], "хижина": ["Жилые дома"], "палата": ["Жилые дома"], "доммастерская": ["Жилые дома"], "ферма": ["Жилые дома"], "поместье": ["Жилые дома"], "доходный дом": ["Жилые дома"], "дом (маленький)": ["Жилые дома"], "шале": ["Жилые дома"], "общежитие": ["Жилые дома"], "величественнный дом": ["Жилые дома"], "сельский дом": ["Жилые дома"], "сторожка": ["Жилые дома"], "особняк": ["Жилые дома"], "изба": ["Жилые дома"], "домкоммуна": ["Жилые дома"], "Больница": ["Объекты здравоохранения"], "Санаторий": ["Объекты здравоохранения"], "Больничные палаты": ["Объекты здравоохранения"], "Поликлиника": ["Объекты здравоохранения"], "Порт": ["Объекты транспорта"], "подстанция": ["Объекты транспорта"], "Платформа": ["Транспортные сооружения"], "Вокзал": ["Объекты транспорта"], "Станция": ["Транспортные сооружения"], "Терминал": ["Объекты транспорта"], "Аэропорт": ["Объекты транспорта"], "гараж": ["Объекты транспорта"], "Трамвайное депо": ["Объекты транспорта"], "Заправка": ["Объекты транспорта"], "Самолетная площадка": ["Объекты транспорта"], "электродепо": ["Объекты транспорта"], "аэродром": ["Объекты транспорта"], "яхтклуб": ["Объекты транспорта"], "Док": ["Объекты транспорта"], "Завод": ["Промышленные объекты"], "солодовня": ["Промышленные объекты"], "бродильня": ["Промышленные объекты"], "ледники": ["Промышленные объекты"], "Цех": ["Промышленные объекты"], "Производство": ["Промышленные объекты"], "Мануфактура": ["Промышленные объекты"], "Пивоварня": ["Промышленные объекты"], "проходная": ["Промышленные объекты"], "Завод по выработке электроэнергии": ["Промышленные объекты"], "Кузница": ["Промышленные объекты"], "фабрикакухня": ["Промышленные объекты"], "флигельмастерская": ["Промышленные объекты"], "Верфь": ["Промышленные объекты"], "домкузница": ["Промышленные объекты"], "фабрика": ["Промышленные объекты"], "электростанция": ["Промышленные объекты"], "очиститель": ["Промышленные объекты"], "Банк": ["Банки и биржи"], "Биржа": ["Банки и биржи"], "Касса": ["Банки и биржи"], "Сберегательные кассы": ["Банки и биржи"], "Тюрьма": ["Военные объекты"], "Казарма": ["Военные объекты"], "укрытие": ["Военные объекты"], "Арсенал": ["Военные объекты"], "Склад": ["Складские объекты"], "амбар": ["Складские объекты"], "ангар": ["Складские объекты"], "сарай": ["Складские объекты"], "хранилище жидкостей": ["Складские объекты"], "погреб": ["Складские объекты"], "Место для хранения": ["Складские объекты"], "Ипподром": ["Спортивные сооружения"], "Спортзал": ["Спортивные сооружения"], "Бассейн": ["Спортивные сооружения"], "Спортивный клуб": ["Спортивные сооружения"], "Спортивная площадка": ["Спортивные сооружения"], "Стадион": ["Спортивные сооружения"], "Трибуна": ["Спортивные сооружения"], "детский дом": ["Социальные учреждения"], "хоспис": ["Социальные учреждения"], "пансионприют": ["Социальные учреждения"], "приют": ["Социальные учреждения"], "пансион": ["Социальные учреждения"], "Мастерская": ["Интерьеры"], "вестибюль": ["Интерьеры"], "холл": ["Интерьеры"], "лоджии": ["Интерьеры"], "зал": ["Интерьеры", "Объекты культуры" ], "Студия": ["Интерьеры"], "Бюро": ["Интерьеры"], "квартира": ["Интерьеры"], "железная дорога": ["Транспортные сооружения"], "дорога": ["Транспортные сооружения"], "туннель": ["Транспортные сооружения"], "эстакада": ["Транспортные сооружения"], "мост": ["Транспортные сооружения"], "пирс": ["Транспортные сооружения"], "Пункт взимания платы на дороге": ["Транспортные сооружения"], "виадук": ["Транспортные сооружения"], "трасса": ["Транспортные сооружения"], "метро": ["Транспортные сооружения"], "поезд": ["Транспортные сооружения"], "тракт": ["Транспортные сооружения"], "метрополитен": ["Транспортные сооружения"], "шлюз": ["Транспортные сооружения"], "пункт": ["Транспортные сооружения"], "башня": ["Инженерные сооружения"], "водонапорный": ["Инженерные сооружения"], "водоёмный": ["Инженерные сооружения"], "арка": ["Инженерные сооружения"], "будка": ["Инженерные сооружения"], "канал": ["Инженерные сооружения"], "амфитеатр": ["Инженерные сооружения"], "водяная башня": ["Инженерные сооружения"], "гидрант": ["Инженерные сооружения"], "помпа": ["Инженерные сооружения"], "бастион": ["Инженерные сооружения"], "подземелье": ["Инженерные сооружения"], "крепость": ["Инженерные сооружения"], "катакомбы": ["Инженерные сооружения"], "плотина": ["Инженерные сооружения"], "акведук": ["Инженерные сооружения"], "waterworks": ["Инженерные сооружения"], "радиобашня": ["Инженерные сооружения"], "коридор под землей": ["Инженерные сооружения"], "коридор": ["Инженерные сооружения"], "дот": ["Оборонительные сооружения"], "оборонительное сооружение": ["Оборонительные сооружения"], "Военный лагерь": ["Оборонительные сооружения"], "ров": ["Оборонительные сооружения"], "Бункер": ["Оборонительные сооружения"], "лагерь": ["Оборонительные сооружения"], "кладбище": ["Пусто"], "парк": ["Пусто"], "сад": ["Пусто"], "питомник": ["Пусто"], "роща": ["Пусто"], "садсиренгарий": ["Пусто"], "сквер": ["Пусто"], "партер": ["Пусто"], "дендропарк": ["Пусто"], "сиренгарий": ["Пусто"], "водоём": ["Ансамбли и Территории исторической застройки"], "заповедник": ["Ансамбли и Территории исторической застройки"], "поле боя": ["Ансамбли и Территории исторической застройки"], "ландшафт": ["Ансамбли и Территории исторической застройки"], "территория": ["Ансамбли и Территории исторической застройки"], "площадь": ["Ансамбли и Территории исторической застройки"], "бульвар": ["Ансамбли и Территории исторической застройки"], "пруд": ["Ансамбли и Территории исторической застройки"], "аллея": ["Ансамбли и Территории исторической застройки"], "каскад": ["Ансамбли и Территории исторической застройки"], "поле": ["Ансамбли и Территории исторической застройки"], "подворье": ["Ансамбли и Территории исторической застройки"], "слобода": ["Ансамбли и Территории исторической застройки"], "поселение": ["Ансамбли и Территории исторической застройки"], "поселок": ["Ансамбли и Территории исторической застройки"], "застройка": ["Ансамбли и Территории исторической застройки"], "село": ["Ансамбли и Территории исторической застройки"], "деревня": ["Ансамбли и Территории исторической застройки"], "вднх": ["Ансамбли и Территории исторической застройки"], "квартал": ["Ансамбли и Территории исторической застройки"], "пенягино": ["Ансамбли и Территории исторической застройки"], "памятник": ["Пусто"], "камень": ["Пусто"], "статуя": ["Пусто"], "ограда": ["Пусто"], "ванны": ["Пусто"], "могила": ["Пусто"], "обелиск": ["Пусто"], "скульптура": ["Пусто"], "алтарь": ["Пусто"], "стела": ["Пусто"], "фонтан": ["Пусто"], "беседка": ["Пусто"], "мемориал": ["Пусто"], "барельеф": ["Пусто"], "бюст": ["Пусто"], "памятникбюст": ["Пусто"], "погост": ["Пусто"], "курганымогильники": ["Пусто"], "место": ["Пусто"], "некрополь": ["Пусто"], "монумент": ["Пусто"], "захоронение": ["Пусто"], "место расстрела": ["Пусто"], "спецобъект": ["Пусто"], "могильник": ["Пусто"], "забор": ["Пусто"], "перила": ["Пусто"], "лифт": ["Пусто"], "фундамент": ["Пусто"], "колоннада": ["Пусто"], "вход": ["Пусто"], "арена": ["Пусто"], "ворота": ["Пусто"], "надстройка": ["Пусто"], "столб": ["Пусто"], "фасад": ["Пусто"], "пандус": ["Пусто"], "тротуар": ["Пусто"], "грот": ["Пусто"], "насыпь": ["Пусто"], "смотровая площадка": ["Пусто"], "руины": ["Пусто"], "панно": ["Пусто"], "подвал": ["Пусто"], "конструкция": ["Пусто"], "надгробие": ["Пусто"], "канава": ["Пусто"], "голубятня": ["Пусто"], "конюшня": ["Пусто"], "мавзолей": ["Пусто"], "крематорий": ["Пусто"], "археология": ["Пусто"], "овраг": ["Пусто"], "оранжерея": ["Пусто"], "урна": ["Пусто"], "элеватор": ["Пусто"], "мозаика": ["Пусто"], "портик": ["Пусто"], "роспись": ["Пусто"], "плафон": ["Пусто"], "стена": ["Пусто"], "павильон": ["Пусто"], "пол": ["Пусто"], "подклет": ["Пусто"], "часы": ["Пусто"], "павильонбеседка": ["Пусто"], "домик": ["Пусто"], "мостик": ["Пусто"], "башнябеседка": ["Пусто"], "беседкаротонда": ["Пусто"], "ограждение": ["Пусто"], "форма": ["Пусто"], "ротонда": ["Пусто"], "рельеф": ["Пусто"], "беседки": ["Пусто"], "конный": ["Пусто"], "церковьсередина": ["Религиозные объекты"], "келья": ["Религиозные объекты"], "торговый": ["Объекты обслуживания"], "проходной": ["Объекты науки и образования"],  "кордегардия": ["Объекты науки и образования"], "гидроканал": ["Объекты науки и образования"], "женский": ["Объекты науки и образования"],  "здание": ["Административные объекты"], "дом": ["Жилые дома"], "клиника": ["Объекты здравоохранения"], "депо": ["Объекты транспорта"], "оперативный": ["Военные объекты"], "складской": ["Складские объекты"], "помещение": ["Интерьеры "], "аудитория": ["Интерьеры "], "мастерские": ["Интерьеры "], "кладовая": ["Интерьеры "], "клубстоловая": ["Интерьеры"], "превратная": ["Ансамбли и Территории исторической застройки"], "городище": ["Пусто"], "селище": ["Пусто"], "курган": ["Пусто"], "курганный": ["Пусто"], "ворот": ["Пусто"], "ансамбль": ["Ансамбли и Территории исторической застройки"], "комплекс": ["Ансамбли и Территории исторической застройки"], "превратная": ["Ансамбли и Территории исторической застройки"], "обитель": ["Ансамбли и Территории исторической застройки"], "сооружение": ["Ансамбли и Территории исторической застройки"], "кирха": ["Религиозные объекты"], "слой": ["Религиозные объекты"], "владение": ["Жилые дома"], "скульптурный": ["Жилые дома"], "часть": ["Другое"]   }
unusable_dict_types = {"строение": ["Здания"], "иное": ["Здания"], "помещение": ["Здания"], "водоём": ["Городской ландшафт"], "издательство": ["Здания"], "Притча": ["Здания"], "Церковь": ["Здания"], "Мужской монастырь": ["Здания"], "Монастырь": ["Здания"], "Храм": ["Здания"], "Часовня": ["Здания"], "Собор": ["Здания"], "Мечеть": ["Здания"], "Колокольня": ["Здания"], "Дом священника": ["Здания"], "Синагога": ["Здания"], "Аббатство (католический монастырь)": ["Здания"], "Базилика": ["Здания"], "Коллегиальная церковь": ["Здания"], "Пристройка для крещения": ["Здания"], "Религиозное объединение": ["Здания"], "Комната для монахов": ["Здания"], "Богадельня": ["Здания"], "Звонница": ["Здания"], "община": ["Здания"], "Усыпальница": ["Здания"], "Магазин": ["Здания"], "Гастроном": ["Здания"], "Бакалея": ["Здания"], "Рынок": ["Здания"], "Лавка": ["Здания"], "Киоск": ["Здания"], "Павильон": ["Здания"], "Пекарня": ["Здания"], "Булочная": ["Здания"], "Аптека": ["Здания"], "Рыбный магазин": ["Здания"], "Молочные продукты": ["Здания"], "Универмаг": ["Здания"], "Ряд магазинов": ["Здания"], "пассаж": ["Здания"], "Торговые ряды": ["Здания"], "Почта": ["Здания"], "скоропечатня": ["Здания"], "Телефонный центр": ["Здания"], "Типография": ["Здания"], "отделение": ["Здания"], "Почтамт": ["Здания"], "Телеграф": ["Здания"], "Общественный туалет": ["Здания"], "баня": ["Здания"], "Академия": ["Здания"], "Колледж": ["Здания"], "Школа": ["Здания"], "Институт": ["Здания"], "Гимназия": ["Здания"], "Университет": ["Здания"], "Лицей": ["Здания"], "Консерватория": ["Здания"], "Детский сад": ["Здания"], "Обсерватория": ["Здания"], "Лаборатория": ["Здания"], "Медицинская школа": ["Здания"], "Техникум": ["Здания"], "Училище": ["Здания"], "Сельскохозяйственная академия": ["Здания"], "Бар": ["Здания"], "Пивная": ["Здания"], "Кафе": ["Здания"], "Ресторан": ["Здания"], "Столовая": ["Здания"], "Трактир": ["Здания"], "Кабак": ["Здания"], "Трапезная": ["Здания"], "Кинотеатр": ["Здания"], "Галерея": ["Здания"], "Театр": ["Здания"], "Центр культуры": ["Здания"], "Дом культуры": ["Здания"], "Концертный зал": ["Здания"], "Клуб": ["Здания"], "Кабаре": ["Здания"], "Казино": ["Здания"], "Цирк": ["Здания"], "фойе": ["Здания"], "электротеатр": ["Здания"], "манеж": ["Здания"], "филармония": ["Здания"], "планетарий": ["Здания"], "Музей": ["Здания"], "Архив": ["Здания"], "Библиотека": ["Здания"], "музей-панорама": ["Здания"], "панорама": ["Здания"], "Гостиница": ["Здания"], "Отель": ["Здания"], "Номер": ["Здания"], "Министерство": ["Здания"], "Дворец": ["Здания"], "Управление": ["Здания"], "общество": ["Здания"], "Кремль": ["Здания"], "Ратуша": ["Здания"], "Кригскомиссариат": ["Здания"], "Таможня": ["Здания"], "полицейская часть": ["Здания"], "контора": ["Здания"], "совет": ["Здания"], "канцелярия": ["Здания"], "Сенат": ["Здания"], "имение": ["Здания"], "дома": ["Здания"], "палаты": ["Здания"], "усадьба": ["Здания"], "замок": ["Здания"], "дача": ["Здания"], "флигель": ["Здания"], "вилла": ["Здания"], "двор": ["Здания"], "конференцзала": ["Здания"], "хижина": ["Здания"], "палата": ["Здания"], "доммастерская": ["Здания"], "ферма": ["Здания"], "поместье": ["Здания"], "доходный дом": ["Здания"], "дом (маленький)": ["Здания"], "шале": ["Здания"], "общежитие": ["Здания"], "величественнный дом": ["Здания"], "сельский дом": ["Здания"], "сторожка": ["Здания"], "особняк": ["Здания"], "изба": ["Здания"], "домкоммуна": ["Здания"], "Больница": ["Здания"], "Санаторий": ["Здания"], "Больничные палаты": ["Здания"], "Поликлиника": ["Здания"], "Порт": ["Здания"], "Платформа": ["Сооружения"], "Вокзал": ["Здания"], "Станция": ["Сооружения"], "Терминал": ["Здания"], "Аэропорт": ["Здания"], "гараж": ["Здания"], "Трамвайное депо": ["Здания"], "Заправка": ["Здания"], "Самолетная площадка": ["Здания"], "электродепо": ["Здания"], "аэродром": ["Здания"], "яхтклуб": ["Здания"], "Док": ["Здания"], "Корпус": ["Здания"], "Завод": ["Здания"], "Цех": ["Здания"], "Производство": ["Здания"], "Мануфактура": ["Здания"], "Пивоварня": ["Здания"], "проходная": ["Здания"], "Завод по выработке электроэнергии": ["Здания"], "Кузница": ["Здания"], "фабрикакухня": ["Здания"], "флигельмастерская": ["Здания"], "Верфь": ["Здания"], "домкузница": ["Здания"], "фабрика": ["Здания"], "электростанция": ["Здания"], "очиститель": ["Здания"], "Банк": ["Здания"], "Биржа": ["Здания"], "Касса": ["Здания"], "Сберегательные кассы": ["Здания"], "Тюрьма": ["Здания"], "Казарма": ["Здания"], "купец": ["Здания"], "укрытие": ["Здания"], "постройка": ["Здания"], "Арсенал": ["Здания"], "поэт": ["Здания"], "Склад": ["Здания"], "амбар": ["Здания"], "ангар": ["Здания"], "сарай": ["Здания"], "хранилище жидкостей": ["Здания"], "погреб": ["Здания"], "Место для хранения": ["Здания"], "Ипподром": ["Сооружения"], "Спортзал": ["Сооружения"], "Бассейн": ["Сооружения"], "Спортивный клуб": ["Сооружения"], "Спортивная площадка": ["Сооружения"], "Стадион": ["Сооружения"], "Трибуна": ["Сооружения"], "детский дом": ["Здания"], "хоспис": ["Здания"], "пансионприют": ["Здания"], "приют": ["Здания"], "пансион": ["Здания"], "Мастерская": ["Здания"], "Студия": ["Здания"], "Бюро": ["Здания"], "квартира": ["Здания"], "железная дорога": ["Сооружения"], "дорога": ["Сооружения"], "туннель": ["Сооружения"], "эстакада": ["Сооружения"], "мост": ["Сооружения"], "пирс": ["Сооружения"], "Пункт взимания платы на дороге": ["Сооружения"], "виадук": ["Сооружения"], "подстанция": ["Здания"], "трасса": ["Сооружения"], "метро": ["Сооружения"], "поезд": ["Сооружения"], "тракт": ["Сооружения"], "метрополитен": ["Сооружения"], "шлюз": ["Сооружения"], "пункт": ["Сооружения"], "башня": ["Сооружения"], "арка": ["Сооружения"], "будка": ["Сооружения"], "канал": ["Сооружения"], "амфитеатр": ["Сооружения"], "водяная башня": ["Сооружения"], "гидрант": ["Сооружения"], "помпа": ["Сооружения"], "бастион": ["Сооружения"], "подземелье": ["Сооружения"], "крепость": ["Сооружения"], "катакомбы": ["Сооружения"], "солодовня": ["Здания"], "бродильня": ["Здания"], "ледники": ["Здания"], "плотина": ["Сооружения"], "акведук": ["Сооружения"], "waterworks": ["Сооружения"], "радиобашня": ["Сооружения"], "коридор под землей": ["Сооружения"], "коридор": ["Сооружения"], "дот": ["Сооружения"], "оборонительное сооружение": ["Сооружения"], "Военный лагерь": ["Сооружения"], "ров": ["Сооружения"], "Бункер": ["Сооружения"], "лагерь": ["Сооружения"], "кладбище": ["Сады и парки"], "парк": ["Сады и парки"], "сад": ["Сады и парки"], "питомник": ["Сады и парки"], "роща": ["Сады и парки"], "садсиренгарий": ["Сады и парки"], "сквер": ["Сады и парки"], "партер": ["Сады и парки"], "дендропарк": ["Сады и парки"], "сиренгарий": ["Сады и парки"], "заповедник": ["Городской ландшафт"], "поле боя": ["Городской ландшафт"], "ландшафт": ["Городской ландшафт"], "территория": ["Городской ландшафт"], "площадь": ["Городской ландшафт"], "бульвар": ["Городской ландшафт"], "пруд": ["Городской ландшафт"], "аллея": ["Городской ландшафт"], "каскад": ["Городской ландшафт"], "поле": ["Городской ландшафт"], "подворье": ["Городской ландшафт"], "слобода": ["Городской ландшафт"], "поселение": ["Городской ландшафт"], "поселок": ["Городской ландшафт"], "застройка": ["Городской ландшафт"], "село": ["Городской ландшафт"], "деревня": ["Городской ландшафт"], "вднх": ["Городской ландшафт"], "квартал": ["Городской ландшафт"], "пенягино": ["Городской ландшафт"], "памятник": ["Монумент / памятник"], "урна": ["Монумент / памятник"], "камень": ["Монумент / памятник"], "статуя": ["Монумент / памятник"], "ограда": ["Монумент / памятник"], "ванны": ["Монумент / памятник"], "могила": ["Монумент / памятник"], "обелиск": ["Монумент / памятник"], "скульптура": ["Монумент / памятник"], "вестибюль": ["Здания"], "холл": ["Здания"], "лоджии": ["Здания"], "зал": ["Здания"], "алтарь": ["Монумент / памятник"], "стела": ["Монумент / памятник"], "беседка": ["Архитектурный элемент"], "мемориал": ["Монумент / памятник"], "барельеф": ["Монумент / памятник"], "бюст": ["Монумент / памятник"], "памятникбюст": ["Монумент / памятник"], "погост": ["Монумент / памятник"], "курганымогильники": ["Монумент / памятник"], "место": ["Монумент / памятник"], "некрополь": ["Монумент / памятник"], "монумент": ["Монумент / памятник"], "захоронение": ["Монумент / памятник"], "место расстрела": ["Монумент / памятник"], "спецобъект": ["Монумент / памятник"], "могильник": ["Монумент / памятник"], "забор": ["Архитектурный элемент"], "перила": ["Архитектурный элемент"], "лифт": ["Архитектурный элемент"], "водонапорный": ["Здания"], "водоёмный": ["Здания"], "фундамент": ["Архитектурный элемент"], "фонтан": ["Архитектурный элемент"], "колоннада": ["Архитектурный элемент"], "вход": ["Архитектурный элемент"], "арена": ["Архитектурный элемент"], "ворота": ["Архитектурный элемент"], "надстройка": ["Архитектурный элемент"], "столб": ["Архитектурный элемент"], "фасад": ["Архитектурный элемент"], "пандус": ["Разное"], "тротуар": ["Разное"], "грот": ["Разное"], "насыпь": ["Разное"], "смотровая площадка": ["Разное"], "руины": ["Разное"], "панно": ["Разное"], "подвал": ["Разное"], "конструкция": ["Разное"], "надгробие": ["Разное"], "канава": ["Разное"], "голубятня": ["Разное"], "конюшня": ["Разное"], "мавзолей": ["Разное"], "крематорий": ["Разное"], "археология": ["Археология"], "здание": ["Здания"], "сооружение": ["Сооружения"], "овраг": ["Сады и парки"], "оранжерея": ["Сады и парки"], "элеватор": ["Архитектурный элемент"], "мозаика": ["Архитектурный элемент"], "портик": ["Архитектурный элемент"], "роспись": ["Архитектурный элемент"], "плафон": ["Архитектурный элемент"], "стена": ["Архитектурный элемент"], "павильон": ["Архитектурный элемент"], "пол": ["Архитектурный элемент"], "подклет": ["Архитектурный элемент"], "часы": ["Архитектурный элемент"], "павильонбеседка": ["Архитектурный элемент"], "домик": ["Архитектурный элемент"], "мостик": ["Архитектурный элемент"], "башнябеседка": ["Архитектурный элемент"], "беседкаротонда": ["Архитектурный элемент"], "ограждение": ["Архитектурный элемент"], "форма": ["Архитектурный элемент"], "ротонда": ["Архитектурный элемент"], "рельеф": ["Архитектурный элемент"], "беседки": ["Архитектурный элемент"], "конный": ["Разное"], "церковьсередина": ["Здания"], "келья": ["Здания"], "торговый": ["Здания"]}
data = pd.read_excel(r'D:\Dev\Pycharm projects\okn\Москва_ОКН_UPD.xlsx')
df = pd.DataFrame(data, columns= ['ansamble_object', 'Вид_ОН'])

def update_dict(old_dict: dict):
    new_dict = {}

    for key in old_dict:
        new_key = key.lower()
        new_dict[new_key] = old_dict[key]

    return new_dict


dict_functions = update_dict(unusable_dict_functions)
dict_types = update_dict(unusable_dict_types)


df['alt_name1'] = ''
df['results_functions'] = ''
df['nlp_list1'] = ''

df['alt_name2'] = ''
df['nlp_list2'] = ''
df['results_types'] = ''

for index, row in df.iterrows():
    row['alt_name1'] = str(row['ansamble_object'])
    row['alt_name1'] = row['alt_name1'].lower()
    row['alt_name1'] = re.sub(r'[^а-яА-Я ]', '', row['alt_name1'])
    row['results_functions'] = []

    row['nlp_list1'] = []
    text = row['alt_name1']
    doc = nlp(text)
    for token in doc:
        if token.pos_ in ('NOUN', 'PROPN', 'ADV', 'ADJ', 'VERB') and len(token.lemma_) >= 2:
            row['nlp_list1'].append(token.lemma_)

    for key in row['nlp_list1']:
        if key in dict_functions:
            row['results_functions'].extend(dict_functions[key])

    row['results_functions'] = list(set(row['results_functions']))

    if not row['results_functions']:
        row['results_functions'] = ['None']

for index, row in df.iterrows():
    row['alt_name2'] = str(row['Вид_ОН'])
    row['alt_name2'] = row['alt_name2'].lower()
    row['alt_name2'] = re.sub(r'[^а-яА-Я ]', '', row['alt_name2'])
    row['results_types'] = []

    row['nlp_list2'] = []
    text = row['alt_name2']
    doc = nlp(text)
    for token in doc:
        if token.pos_ in ('NOUN', 'PROPN', 'ADV', 'ADJ', 'VERB') and len(token.lemma_) >= 2:
            row['nlp_list2'].append(token.lemma_)

    for key in row['nlp_list2']:
        if key in dict_types:
            row['results_types'].extend(dict_types[key])


    row['results_types'] = list(set(row['results_types']))

    if not row['results_types']:
        row['results_types'] = ['None']

df.to_excel(r'D:\Dev\Pycharm projects\okn\Москва_ОКН_UPD-output.xlsx', sheet_name='Sheet1', index = False)



