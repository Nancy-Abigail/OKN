# coding=UTF-8

import pandas as pd
import re
import spacy

nlp = spacy.load("en_core_web_sm")

unusable_dict_functions = {"mithraeum": ["Религиозные объекты"], "build": ["Объекты обслуживания"], "building": ["Объекты обслуживания"], "pleasance": ["Объекты науки и образования"], "playground": ["Объекты науки и образования"], "tea": ["Объекты общепита"], "exhibition": ["Объекты культуры"], "hall": ["Объекты культуры", "Жилые дома"], "freemason": ["Объекты культуры"], "residence": ["Жилые дома"], "industrial ": ["Промышленные объекты"], "studio": ["Интерьеры"], "reading": ["Интерьеры"], "waterfront": ["Инженерные сооружения"], "conservatory": ["Пустое"], "structure": ["Ансамбли и Территории исторической застройки"], "tombstone": ["Пустое"], "floor": ["Пустое"], "tessellate": ["Пустое"], "hillfort": ["Пустое"], "wreck": ["Пустое"], "earthwork": ["Пустое"], "gun": ["Пустое"], "pen": ["Пустое"], "Church": ["Религиозные объекты"], "friary": ["Религиозные объекты"], "Monastery": ["Религиозные объекты"], "Temple": ["Религиозные объекты"], "Chapel": ["Религиозные объекты"], "nunnery": ["Религиозные объекты"], "priory": ["Религиозные объекты"], "Cathedral": ["Религиозные объекты"], "Mosque": ["Религиозные объекты"], "Bell": ["Религиозные объекты"], "Refectory": ["Религиозные объекты"], "vicarage": ["Религиозные объекты"], "abbey": ["Религиозные объекты"], "deanery": ["Религиозные объекты"], "synagogue": ["Религиозные объекты"], "crypt": ["Религиозные объекты"], "vestry": ["Религиозные объекты"], "agapemone": ["Религиозные объекты"], "manse": ["Религиозные объекты"], "presbyterian": ["Религиозные объекты"], "Shop": ["Объекты обслуживания"], "Grocery store": ["Объекты обслуживания"], "Grocery stores": ["Объекты обслуживания"], "Market": ["Объекты обслуживания"], "Kiosk": ["Объекты обслуживания"], "storehouse": ["Объекты обслуживания"], "Pavilion": ["Объекты обслуживания"], "Bakery": ["Объекты обслуживания"], "Pharmacy": ["Объекты обслуживания"], "shopping": ["Объекты обслуживания"], "store": ["Объекты обслуживания"], "dairy": ["Объекты обслуживания"], "pawnshop": ["Объекты обслуживания"], "supermarket": ["Объекты обслуживания"], "Post": ["Объекты обслуживания"], "laundry": ["Объекты обслуживания"], "convenience": ["Объекты обслуживания"], "telegraph": ["Объекты обслуживания"], "letter": ["Объекты обслуживания"], "magazine": ["Объекты обслуживания"], "signal": ["Объекты обслуживания"], "box": ["Объекты обслуживания"], "bathhouse": ["Объекты обслуживания"], "Academy": ["Объекты науки и образования"], "College": ["Объекты науки и образования"], "School": ["Объекты науки и образования"], "Institute": ["Объекты науки и образования"], "Gymnasium": ["Объекты науки и образования"], "University": ["Объекты науки и образования"], "Lyceum": ["Объекты науки и образования"], "Conservatoire": ["Объекты науки и образования"], "Kindergarten": ["Объекты науки и образования"], "Observatory": ["Объекты науки и образования"], "Laboratory": ["Объекты науки и образования"], "schoolroom": ["Объекты науки и образования"], "Bar": ["Объекты общепита"], "Beer": ["Объекты общепита"], "Cafe": ["Объекты общепита"], "Restaurant": ["Объекты общепита"], "Canteen": ["Объекты общепита"], "Public house": ["Объекты общепита"], "Tavern": ["Объекты общепита"], "cabaret": ["Объекты общепита"], "tearoom": ["Объекты общепита"], "cookhouse": ["Объекты общепита"], "buffet": ["Объекты общепита"], "Cinema": ["Объекты культуры"], "Gallery": ["Объекты культуры"], "Theatre": ["Объекты культуры"], "Cultural Center": ["Объекты культуры"], "House of Culture": ["Объекты культуры"], "showroom": ["Объекты культуры"], "Concert Hall": ["Объекты культуры"], "Club": ["Объекты культуры"], "guildhall": ["Объекты культуры"], "Museum": ["Объекты культуры"], "Archive": ["Объекты культуры"], "Library": ["Объекты культуры"], "chancery": ["Объекты культуры"], "Hotel": ["Гостиницы"], "hostel": ["Гостиницы"], "Ministry": ["Административные объекты"], "Palace": ["Административные объекты"], "department": ["Административные объекты"], "community": ["Административные объекты"], "government": ["Административные объекты"], "office": ["Административные объекты"], "centre": ["Административные объекты"], "court": ["Административные объекты"], "police": ["Административные объекты"], "embassy": ["Административные объекты"], "subsistence": ["Административные объекты"], "clubhouse": ["Административные объекты"], "chamber": ["Административные объекты"], "estate": ["Жилые дома"], "lodge": ["Жилые дома"], "farmhouse": ["Жилые дома"], "manor": ["Жилые дома"], "castle": ["Жилые дома"], "cottage": ["Жилые дома"], "outbuilding": ["Жилые дома"], "villa": ["Жилые дома"], "yard": ["Жилые дома"], "hut": ["Жилые дома"], "outbuilde": ["Жилые дома"], "farm": ["Жилые дома"], "dwelling": ["Жилые дома"], "gatehouse": ["Жилые дома"], "home": ["Жилые дома"], "house": ["Жилые дома"], "dwell": ["Жилые дома"], "summerhouse": ["Жилые дома"], "bungalow": ["Жилые дома"], "country": ["Жилые дома"], "quarter": ["Жилые дома"], "married": ["Жилые дома"], "row": ["Жилые дома"], "maisonette": ["Жилые дома"], "tenement": ["Жилые дома"], "Hospital": ["Объекты здравоохранения"], "Sanatorium": ["Объекты здравоохранения"], "surgery": ["Объекты здравоохранения"], "enclosure": ["Объекты здравоохранения"], "nursing": ["Объекты здравоохранения"], "dispensary": ["Объекты здравоохранения"], "clinic": ["Объекты здравоохранения"], "hospitaller": ["Объекты здравоохранения"], "maternity": ["Объекты здравоохранения"], "Port": ["Объекты транспорта"], "Platform": ["Транспортные сооружения"], "Railway station": ["Объекты транспорта"], "Station": ["Транспортные сооружения"], "tramway": ["Объекты транспорта"], "garage": ["Объекты транспорта"], "depot": ["Объекты транспорта"], "porter": ["Объекты транспорта"], "terminal": ["Объекты транспорта"], "launchway": ["Объекты транспорта"], "Factory": ["Промышленные объекты"], "Shop floor": ["Промышленные объекты"], "Production": ["Промышленные объекты"], "Manufactory": ["Промышленные объекты"], "brewery": ["Промышленные объекты"], "Pass-through": ["Промышленные объекты"], "work": ["Промышленные объекты"], "mill": ["Промышленные объекты"], "gas holder": ["Промышленные объекты"], "holder": ["Промышленные объекты"], "sailmake": ["Промышленные объекты"], "silo": ["Промышленные объекты"], "textile": ["Промышленные объекты"], "engine": ["Промышленные объекты"], "manufacturing": ["Промышленные объекты"], "tannery": ["Промышленные объекты"], "Bank": ["Банки и биржи"], "Stock market": ["Банки и биржи"], "mint": ["Банки и биржи"], "exchange": ["Банки и биржи"], "Fortress": ["Военные объекты"], "sergeant": ["Военные объекты"], "officer": ["Военные объекты"], "Prison": ["Военные объекты"], "Barracks": ["Военные объекты"], "guardhouse": ["Военные объекты"], "barrack": ["Военные объекты"], "military": ["Военные объекты"], "Warehouse": ["Складские объекты"], "mews": ["Складские объекты"], "barn": ["Складские объекты"], "hangar": ["Складские объекты"], "granary": ["Складские объекты"], "larder": ["Складские объекты"], "shed": ["Складские объекты"], "icehouse": ["Складские объекты"], "vault": ["Складские объекты"], "pound": ["Складские объекты"], "buttery": ["Складские объекты"], "Racetrack": ["Спортивные сооружения"], "Gym": ["Спортивные сооружения"], "sport": ["Спортивные сооружения"], "tennis": ["Спортивные сооружения"], "pool": ["Спортивные сооружения"], "lido": ["Спортивные сооружения"], "grandstand": ["Спортивные сооружения"], "stadium": ["Спортивные сооружения"], "orphan": ["Социальные учреждения"], "shelter": ["Социальные учреждения"], "orphanage": ["Социальные учреждения"], "homeless": ["Социальные учреждения"], "workhouse": ["Социальные учреждения"], "almshouse": ["Социальные учреждения"], "nursery": ["Социальные учреждения"], "Workshop": ["Интерьеры"], "Atelier": ["Интерьеры"], "Bureau": ["Интерьеры"], "furniture": ["Интерьеры"], "apartment": ["Интерьеры"], "flat": ["Интерьеры"], "railway": ["Транспортные сооружения"], "tunnel": ["Транспортные сооружения"], "overpass": ["Транспортные сооружения"], "bridge": ["Транспортные сооружения"], "pier": ["Транспортные сооружения"], "footbridge": ["Транспортные сооружения"], "wharf": ["Транспортные сооружения"], "aircraft": ["Транспортные сооружения"], "viaduct": ["Транспортные сооружения"], "jetty": ["Транспортные сооружения"], "subway": ["Транспортные сооружения"], "dispersal": ["Транспортные сооружения"], "dock": ["Транспортные сооружения"], "QUAY": ["Транспортные сооружения"], "tower": ["Инженерные сооружения"], "arch": ["Инженерные сооружения"], "transmitter": ["Инженерные сооружения"], "booth": ["Инженерные сооружения"], "canal": ["Инженерные сооружения"], "amphitheater": ["Инженерные сооружения"], "waterwork": ["Инженерные сооружения"], "aqueduct": ["Инженерные сооружения"], "bastion": ["Инженерные сооружения"], "drain": ["Инженерные сооружения"], "pump": ["Инженерные сооружения"], "conduit": ["Инженерные сооружения"], "ventilation": ["Инженерные сооружения"], "pipe": ["Инженерные сооружения"], "revetment": ["Инженерные сооружения"], "causeway": ["Инженерные сооружения"], "valve": ["Инженерные сооружения"], "kiln": ["Инженерные сооружения"], "windmill": ["Инженерные сооружения"], "point": ["Инженерные сооружения"], "chimney": ["Инженерные сооружения"], "cistern": ["Инженерные сооружения"], "shaft": ["Инженерные сооружения"], "electricity": ["Инженерные сооружения"], "culvert": ["Инженерные сооружения"], "brewhouse": ["Инженерные сооружения"], "reservoir": ["Инженерные сооружения"], "defence": ["Оборонительные сооружения"], "moat": ["Оборонительные сооружения"], "Bunker": ["Оборонительные сооружения"], "cemetery": ["Пусто"], "park": ["Пусто"], "garden": ["Пусто"], "parktree": ["Пусто"], "conservatoryfernery": ["Пусто"], "cemeterygarden": ["Пусто"], "zoo": ["Пусто"], "cascade": ["Пусто"], "aviary": ["Пусто"], "skatepark": ["Пусто"], "outdoor": ["Пусто"], "forecourt": ["Пусто"], "courtyard": ["Пусто"], "conservation area": ["Ансамбли и Территории исторической застройки"], "battlefield": ["Ансамбли и Территории исторической застройки"], "landscape": ["Ансамбли и Территории исторической застройки"], "Square": ["Ансамбли и Территории исторической застройки"], "road": ["Ансамбли и Территории исторической застройки"], "alley": ["Ансамбли и Территории исторической застройки"], "settlement": ["Ансамбли и Территории исторической застройки"], "block": ["Ансамбли и Территории исторической застройки"], "promenade": ["Ансамбли и Территории исторической застройки"], "monument": ["Пустое"], "stone": ["Пустое"], "statue": ["Пустое"], "baths": ["Пустое"], "tomb": ["Пустое"], "obelisk": ["Пустое"], "sculpture": ["Пустое"], "altar": ["Пустое"], "stele": ["Пустое"], "relief": ["Пустое"], "grave": ["Пустое"], "war memorial": ["Пустое"], "sarcophagus": ["Пустое"], "bust": ["Пустое"], "milestone": ["Пустое"], "bollard": ["Пустое"], "war": ["Пустое"], "memorial": ["Пустое"], "fountain": ["Пустое"], "gravestone": ["Пустое"], "cannon": ["Пустое"], "head": ["Пустое"], "column": ["Пустое"], "pagoda": ["Пустое"], "bath": ["Пустое"], "boundary": ["Пустое"], "barrow": ["Пустое"], "sphinx": ["Пустое"], "bowl": ["Пустое"], "funerary": ["Пустое"], "undercroft": ["Пустое"], "bench": ["Пустое"], "flagpole": ["Пустое"], "landing": ["Пустое"], "pavement": ["Пустое"], "ohel": ["Пустое"], "railing": ["Пустое"], "elevator": ["Пустое"], "wall": ["Пустое"], "frontier": ["Пустое"], "slipway": ["Пустое"], "terrace": ["Пустое"], "steps": ["Пустое"], "step": ["Пустое"], "balustrade": ["Пустое"], "fragment": ["Пустое"], "colonnade": ["Пустое"], "plaque": ["Пустое"], "gate": ["Пустое"], "lock": ["Пустое"], "milepost": ["Пустое"], "basement": ["Пустое"], "loggia": ["Пустое"], "capstan": ["Пустое"], "mosaic": ["Пустое"], "pylon": ["Пустое"], "pillar": ["Пустое"], "ramp": ["Пустое"], "gazebo": ["Пустое"], "sidewalk": ["Пустое"], "grotto": ["Пустое"], "embankment": ["Пустое"], "mew": ["Пустое"], "urn": ["Пустое"], "cellar": ["Пустое"], "kennel": ["Пустое"], "trough": ["Пустое"], "belvedere": ["Пустое"], "zebra": ["Пустое"], "Sign": ["Пустое"], "lamp": ["Пустое"], "inn": ["Пустое"], "mausoleum": ["Пустое"], "crematorium": ["Пустое"], "rest": ["Пустое"], "graffiti": ["Пустое"], "dovecote": ["Пустое"], "folly": ["Пустое"], "glasshouse": ["Пустое"], "bandstand": ["Пустое"], "gardenkitchen": ["Пустое"], "sundial": ["Пустое"], "vase": ["Пустое"], "orangery": ["Пустое"], "fence": ["Пустое"], "stable": ["Пустое"], "archeology": ["Пустое"]}
unusable_dict_types = {"mithraeum": ["Здания"], "build": ["Здания"], "building": ["Здания"], "pleasance": ["Здания"], "playground": ["Здания"], "tea": ["Здания"], "exhibition": ["Здания"], "hall": ["Здания"], "freemason": ["Здания"], "hall": ["Здания"], "residence": ["Здания"], "industrial ": ["Здания"], "studio": ["Здания"], "reading": ["Здания"], "waterfront": ["Сооружения"], "conservatory": ["Сады и парки"], "structure": ["Городской ландшафт"], "tombstone": ["Монумент / памятник"], "floor": ["Архитектурный элемент"], "tessellate": ["Архитектурный элемент"], "hillfort": ["Археология"], "wreck": ["Археология"], "earthwork": ["Археология"], "gun": ["Археология"], "pen": ["Археология"], "Church": ["Здания"], "friary": ["Здания"], "Monastery": ["Здания"], "Temple": ["Здания"], "Chapel": ["Здания"], "nunnery": ["Здания"], "priory": ["Здания"], "Cathedral": ["Здания"], "Mosque": ["Здания"], "Bell": ["Здания"], "Refectory": ["Здания"], "vicarage": ["Здания"], "abbey": ["Здания"], "deanery": ["Здания"], "synagogue": ["Здания"], "crypt": ["Здания"], "vestry": ["Здания"], "agapemone": ["Здания"], "manse": ["Здания"], "presbyterian": ["Здания"], "Shop": ["Здания"], "Grocery store": ["Здания"], "Grocery stores": ["Здания"], "Market": ["Здания"], "Kiosk": ["Здания"], "storehouse": ["Здания"], "Pavilion": ["Здания"], "Bakery": ["Здания"], "Pharmacy": ["Здания"], "shopping": ["Здания"], "store": ["Здания"], "dairy": ["Здания"], "pawnshop": ["Здания"], "supermarket": ["Здания"], "Post": ["Здания"], "laundry": ["Здания"], "convenience": ["Здания"], "telegraph": ["Здания"], "letter": ["Здания"], "magazine": ["Здания"], "signal": ["Здания"], "box": ["Здания"], "bathhouse": ["Здания"], "Academy": ["Здания"], "College": ["Здания"], "School": ["Здания"], "Institute": ["Здания"], "Gymnasium": ["Здания"], "University": ["Здания"], "Lyceum": ["Здания"], "Conservatoire": ["Здания"], "Kindergarten": ["Здания"], "Observatory": ["Здания"], "Laboratory": ["Здания"], "schoolroom": ["Здания"], "Bar": ["Здания"], "Beer": ["Здания"], "Cafe": ["Здания"], "Restaurant": ["Здания"], "Canteen": ["Здания"], "Public house": ["Здания"], "Tavern": ["Здания"], "cabaret": ["Здания"], "tearoom": ["Здания"], "cookhouse": ["Здания"], "buffet": ["Здания"], "Cinema": ["Здания"], "Gallery": ["Здания"], "Theatre": ["Здания"], "Cultural Center": ["Здания"], "House of Culture": ["Здания"], "showroom": ["Здания"], "Concert Hall": ["Здания"], "Club": ["Здания"], "guildhall": ["Здания"], "Museum": ["Здания"], "Archive": ["Здания"], "Library": ["Здания"], "chancery": ["Здания"], "Hotel": ["Здания"], "hostel": ["Здания"], "Ministry": ["Здания"], "Palace": ["Здания"], "department": ["Здания"], "community": ["Здания"], "government": ["Здания"], "office": ["Здания"], "centre": ["Здания"], "court": ["Здания"], "police": ["Здания"], "embassy": ["Здания"], "subsistence": ["Здания"], "clubhouse": ["Здания"], "chamber": ["Здания"], "estate": ["Здания"], "lodge": ["Здания"], "farmhouse": ["Здания"], "manor": ["Здания"], "castle": ["Здания"], "cottage": ["Здания"], "outbuilding": ["Здания"], "villa": ["Здания"], "yard": ["Здания"], "hut": ["Здания"], "outbuilde": ["Здания"], "farm": ["Здания"], "dwelling": ["Здания"], "gatehouse": ["Здания"], "home": ["Здания"], "house": ["Здания"], "dwell": ["Здания"], "summerhouse": ["Здания"], "bungalow": ["Здания"], "country": ["Здания"], "quarter": ["Здания"], "married": ["Здания"], "row": ["Здания"], "maisonette": ["Здания"], "tenement": ["Здания"], "Hospital": ["Здания"], "Sanatorium": ["Здания"], "surgery": ["Здания"], "enclosure": ["Здания"], "nursing": ["Здания"], "dispensary": ["Здания"], "clinic": ["Здания"], "hospitaller": ["Здания"], "maternity": ["Здания"], "Port": ["Здания"], "Platform": ["Сооружения"
                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                              ""], "Railway station": ["Здания"], "Station": ["Сооружения"], "tramway": ["Здания"], "garage": ["Здания"], "depot": ["Здания"], "porter": ["Здания"], "terminal": ["Здания"], "launchway": ["Здания"], "Factory": ["Здания"], "Shop floor": ["Здания"], "Production": ["Здания"], "Manufactory": ["Здания"], "brewery": ["Здания"], "Pass-through": ["Здания"], "work": ["Здания"], "mill": ["Здания"], "gas holder": ["Здания"], "holder": ["Здания"], "sailmake": ["Здания"], "silo": ["Здания"], "textile": ["Здания"], "engine": ["Здания"], "manufacturing": ["Здания"], "tannery": ["Здания"], "Bank": ["Здания"], "Stock market": ["Здания"], "mint": ["Здания"], "exchange": ["Здания"], "Fortress": ["Здания"], "sergeant": ["Здания"], "officer": ["Здания"], "Prison": ["Здания"], "Barracks": ["Здания"], "guardhouse": ["Здания"], "barrack": ["Здания"], "military": ["Здания"], "Warehouse": ["Здания"], "mews": ["Здания"], "barn": ["Здания"], "hangar": ["Здания"], "granary": ["Здания"], "larder": ["Здания"], "shed": ["Здания"], "icehouse": ["Здания"], "vault": ["Здания"], "pound": ["Здания"], "buttery": ["Здания"], "Racetrack": ["Сооружения"], "Gym": ["Сооружения"], "sport": ["Сооружения"], "tennis": ["Сооружения"], "pool": ["Сооружения"], "lido": ["Сооружения"], "grandstand": ["Сооружения"], "stadium": ["Сооружения"], "orphan": ["Здания"], "shelter": ["Здания"], "orphanage": ["Здания"], "homeless": ["Здания"], "workhouse": ["Здания"], "almshouse": ["Здания"], "nursery": ["Здания"], "Workshop": ["Здания"], "Atelier": ["Здания"], "Bureau": ["Здания"], "furniture": ["Здания"], "apartment": ["Здания"], "flat": ["Здания"], "railway": ["Сооружения"], "tunnel": ["Сооружения"], "overpass": ["Сооружения"], "bridge": ["Сооружения"], "pier": ["Сооружения"], "footbridge": ["Сооружения"], "wharf": ["Сооружения"], "aircraft": ["Сооружения"], "viaduct": ["Сооружения"], "jetty": ["Сооружения"], "subway": ["Сооружения"], "dispersal": ["Сооружения"], "dock": ["Сооружения"], "QUAY": ["Сооружения"], "tower": ["Сооружения"], "arch": ["Сооружения"], "transmitter": ["Сооружения"], "booth": ["Сооружения"], "canal": ["Сооружения"], "amphitheater": ["Сооружения"], "waterwork": ["Сооружения"], "aqueduct": ["Сооружения"], "bastion": ["Сооружения"], "drain": ["Сооружения"], "pump": ["Сооружения"], "conduit": ["Сооружения"], "ventilation": ["Сооружения"], "pipe": ["Сооружения"], "revetment": ["Сооружения"], "causeway": ["Сооружения"], "valve": ["Сооружения"], "kiln": ["Сооружения"], "windmill": ["Сооружения"], "point": ["Сооружения"], "chimney": ["Сооружения"], "cistern": ["Сооружения"], "shaft": ["Сооружения"], "electricity": ["Сооружения"], "culvert": ["Сооружения"], "brewhouse": ["Сооружения"], "reservoir": ["Сооружения"], "defence": ["Сооружения"], "moat": ["Сооружения"], "Bunker": ["Сооружения"], "cemetery": ["Сады и парки"], "park": ["Сады и парки"], "garden": ["Сады и парки"], "parktree": ["Сады и парки"], "conservatoryfernery": ["Сады и парки"], "cemeterygarden": ["Сады и парки"], "Zoo": ["Сады и парки"], "Cascade": ["Сады и парки"], "Aviary": ["Сады и парки"], "Skatepark": ["Сады и парки"], "Outdoor": ["Сады и парки"], "forecourt": ["Сады и парки"], "courtyard": ["Сады и парки"], "conservation area": ["Городской ландшафт"], "battlefield": ["Городской ландшафт"], "landscape": ["Городской ландшафт"], "Square": ["Городской ландшафт"], "road": ["Городской ландшафт"], "alley": ["Городской ландшафт"], "settlement": ["Городской ландшафт"], "block": ["Городской ландшафт"], "promenade": ["Городской ландшафт"], "monument": ["Монумент / памятник"], "stone": ["Монумент / памятник"], "statue": ["Монумент / памятник"], "baths": ["Монумент / памятник"], "tomb": ["Монумент / памятник"], "obelisk": ["Монумент / памятник"], "sculpture": ["Монумент / памятник"], "altar": ["Монумент / памятник"], "stele": ["Монумент / памятник"], "relief": ["Монумент / памятник"], "grave": ["Монумент / памятник"], "war memorial": ["Монумент / памятник"], "sarcophagus": ["Монумент / памятник"], "bust": ["Монумент / памятник"], "milestone": ["Монумент / памятник"], "bollard": ["Монумент / памятник"], "war": ["Монумент / памятник"], "memorial": ["Монумент / памятник"], "fountain": ["Монумент / памятник"], "gravestone": ["Монумент / памятник"], "cannon": ["Монумент / памятник"], "head": ["Монумент / памятник"], "column": ["Монумент / памятник"], "pagoda": ["Монумент / памятник"], "bath": ["Монумент / памятник"], "boundary": ["Монумент / памятник"], "barrow": ["Монумент / памятник"], "sphinx": ["Монумент / памятник"], "bowl": ["Монумент / памятник"], "funerary": ["Монумент / памятник"], "undercroft": ["Монумент / памятник"], "bench": ["Монумент / памятник"], "flagpole": ["Монумент / памятник"], "landing": ["Монумент / памятник"], "pavement": ["Монумент / памятник"], "ohel": ["Монумент / памятник"], "railing": ["Архитектурный элемент"], "elevator": ["Архитектурный элемент"], "wall": ["Архитектурный элемент"], "frontier": ["Архитектурный элемент"], "slipway": ["Архитектурный элемент"], "terrace": ["Архитектурный элемент"], "steps": ["Архитектурный элемент"], "step": ["Архитектурный элемент"], "balustrade": ["Архитектурный элемент"], "fragment": ["Архитектурный элемент"], "colonnade": ["Архитектурный элемент"], "plaque": ["Архитектурный элемент"], "gate": ["Архитектурный элемент"], "lock": ["Архитектурный элемент"], "milepost": ["Архитектурный элемент"], "basement": ["Архитектурный элемент"], "loggia": ["Архитектурный элемент"], "capstan": ["Архитектурный элемент"], "mosaic": ["Архитектурный элемент"], "pylon": ["Архитектурный элемент"], "pillar": ["Архитектурный элемент"], "ramp": ["Разное"], "gazebo": ["Разное"], "sidewalk": ["Разное"], "grotto": ["Разное"], "embankment": ["Разное"], "mew": ["Разное"], "urn": ["Разное"], "cellar": ["Разное"], "kennel": ["Разное"], "trough": ["Разное"], "belvedere": ["Разное"], "zebra": ["Разное"], "Sign": ["Разное"], "lamp": ["Разное"], "inn": ["Разное"], "mausoleum": ["Разное"], "crematorium": ["Разное"], "rest": ["Разное"], "graffiti": ["Разное"], "dovecote": ["Разное"], "folly": ["Разное"], "glasshouse": ["Разное"], "bandstand": ["Разное"], "gardenkitchen": ["Разное"], "sundial": ["Разное"], "vase": ["Разное"], "orangery": ["Разное"], "fence": ["Разное"], "stable": ["Разное"], "archeology": ["Археология"]}
data = pd.read_excel(r'D:\Dev\Pycharm projects\okn\FINAL\london-nhle.xlsx')
df = pd.DataFrame(data, columns= ['Monument Type_NEW'])


def update_dict(old_dict: dict):
    new_dict = {}

    for key in old_dict:
        new_key = key.lower()
        new_dict[new_key] = old_dict[key]

    return new_dict


dict_functions = update_dict(unusable_dict_functions)
dict_types = update_dict(unusable_dict_types)


df['alt_name'] = ''
df['dict_keys'] = ''
df['results_functions'] = ''
df['nlp_list'] = ''
df['results_types'] = ''

for index, row in df.iterrows():
    row['alt_name'] = str(row['Monument Type_NEW'])
    row['alt_name'] = row['alt_name'].lower()
    row['alt_name'] = re.sub(r'[^a-zA-Z ]', '', row['alt_name'])
    row['dict_keys'] = []
    row['results_functions'] = []
    row['results_types'] = []

    row['nlp_list'] = []
    text = row['alt_name']
    doc = nlp(text)
    for token in doc:
        if token.pos_ in ('NOUN', 'PROPN', 'ADV', 'ADJ', 'VERB') and len(token.lemma_) >= 2:
            row['nlp_list'].append(token.lemma_)

    for key in row['nlp_list']:
        if key in dict_functions:
            row['results_functions'].extend(dict_functions[key])
        if key in dict_types:
            row['results_types'].extend(dict_types[key])

    row['results_functions'] = list(set(row['results_functions']))
    row['results_types'] = list(set(row['results_types']))

    if not row['results_functions']:
        row['results_functions'] = ['None']
    if not row['results_types']:
        row['results_types'] = ['None']



df.to_excel(r'D:\Dev\Pycharm projects\okn\FINAL\london-nhle-output.xlsx', sheet_name='Sheet1', index = False)



