# coding=UTF-8

import pandas as pd
import re
import spacy

nlp = spacy.load("it_core_news_sm")

unusable_dict_functions = {"acropoli": ["Пусто"], "nido": ["Социальные учреждения"], "autostazione": ["Транспортные сооружения"], "azienda": ["Жилые дома "], "banchina": ["Пусто"], "basamento": ["Пусто"], "castelliere": ["Военные объекты"], "centrale": ["Промышленные объекты"], "fortificativa": ["Военные объекты"], "luogo": ["Объекты обслуживания"], "masseria": ["Жилые дома "], "posto": ["Объекты обслуживания"], "rifugiare": ["Социальные учреждения"], "murario": ["Пусто"], "taverna": ["Объекты общепита"], "viario": ["Ансамбли и Территории исторической застройки"], "trullo": ["Жилые дома"], "universit": ["Объекты науки и образования"], "villaggio": ["Ансамбли и Территории исторической застройки"], "zecca": ["Банки и биржи"], "basilico": ["Религиозные объекты"], "cascia": ["Религиозные объекты"], "orefice": ["Религиозные объекты"], "sapere": ["Религиозные объекты"], "salare": ["Религиозные объекты"], "stefano": ["Религиозные объекты"], "sstefano": ["Религиозные объекты"], "sandrea": ["Религиозные объекты"], "ssandrea": ["Религиозные объекты"], "scaterina": ["Религиозные объекты"], "corsini": ["Религиозные объекты"], "sciriaca": ["Религиозные объекты"], "spezieria": ["Объекты обслуживания"], "ufficiare": ["Объекты обслуживания"], "edicola": ["Объекты обслуживания"], "ateneo": ["Объекты науки и образования"], "coffee": ["Объекты общепита"], "caffeehaus": ["Объекты общепита"], "locale": ["Объекты общепита"], "caffo": ["Объекты общепита"], "casilino": ["Объекты культуры"], "inps": ["Административные объекты"], "mibact": ["Административные объекты"], "campionario": ["Административные объекты"], "termoelettrico": ["Промышленные объекты"], "biblnazionale": ["Промышленные объекты"], "carabiniere": ["Промышленные объекты"], "militare ": ["Военные объекты"], "scuderia": ["Складские объекты"], "stalla": ["Складские объекты"], "salone": ["Интерьеры"], "filippo": ["Другое"], "ssgiovanni": ["Другое"], "montesanto": ["Другое"], "tolentino": ["Другое"], "cd": ["Другое"], "robertini": ["Другое"], "torrione": ["Пустое"], "mazzalupetto": ["Пустое"], "complesso": ["Ансамбли и Территории исторической застройки"], "necropoli": ["Пустое"], "archeologico": ["Пустое"], "resto": ["Пустое"], "insediamento": ["Пустое"], "avanzo": ["Пустое"], "cloaca": ["Пустое"], "horrea": ["Пустое"], "terme": ["Пустое"], "caupona": ["Пустое"], "macellum": ["Пустое"], "tabernae": ["Пустое"], "thermopolium": ["Пустое"], "maximus": ["Пустое"], "sacello": ["Пустое"], "scavo": ["Пустое"], "vicus": ["Пустое"], "veio": ["Пустое"], "ipogeo": ["Пустое"], "citta": ["Пустое"], "immobile": ["Пустое"], "muraglia": ["Пустое"], "abitare": ["Пустое"], "blocco": ["Пустое"], "excubitorium": ["Пустое"], "saepta": ["Пустое"], "colombario": ["Пустое"], "piramide": ["Пустое"], "clivo": ["Пустое"], "campidoglio": ["Пустое"], "vulcano": ["Пустое"], "murare": ["Пустое"], "paedagogium": ["Пустое"], "rampare": ["Пустое"], "terrazzare": ["Пустое"], "fonte": ["Пустое"], "emiciclo": ["Пустое"], "triclinio": ["Пустое"], "regio": ["Пустое"], "templum": ["Пустое"], "traforo": ["Пустое"], "ludus": ["Пустое"], "colombari": ["Пустое"], "rudere": ["Пустое"], "trofeo": ["Пустое"], "ambulacro": ["Пустое"], "giacimento": ["Пустое"], "fidenae": ["Пустое"], "costruzione": ["Пустое"], "fortificare": ["Пустое"], "gabii": ["Пустое"], "Chiesa": ["Религиозные объекты"], "convento": ["Религиозные объекты"], "Monastero": ["Религиозные объекты"], "Tempio": ["Религиозные объекты"], "Cappella": ["Религиозные объекты"], "cenobio": ["Религиозные объекты"], "chiesetta": ["Религиозные объекты"], "Cattedrale": ["Религиозные объекты"], "Moschea": ["Религиозные объекты"], "Campanile": ["Религиозные объекты"], "Refettorio": ["Религиозные объекты", "Объекты общепита"], "canonica": ["Религиозные объекты"], "sinagoga": ["Религиозные объекты"], "abbazia": ["Религиозные объекты"], "basilica": ["Религиозные объекты"], "collegiata": ["Религиозные объекты"], "battistero": ["Религиозные объекты"], "beghinaggio": ["Религиозные объекты"], "cella": ["Религиозные объекты"], "regina": ["Религиозные объекты"], "marcellino": ["Религиозные объекты"], "scesareo": ["Религиозные объекты"], "tempietto": ["Религиозные объекты"], "curia": ["Религиозные объекты"], "certosa": ["Религиозные объекты"], "santuario": ["Религиозные объекты"], "exchiesa": ["Религиозные объекты"], "Oratorio": ["Религиозные объекты"], "pantheon": ["Религиозные объекты"], "canonico": ["Религиозные объекты"], "campitelli": ["Религиозные объекты"], "silvestro": ["Религиозные объекты"], "chiostro": ["Религиозные объекты"], "immacolato": ["Религиозные объекты"], "sagrestia": ["Религиозные объекты"], "antisagrestia": ["Религиозные объекты"], "rotondo": ["Религиозные объекты"], "exconvento": ["Религиозные объекты"], "ospizio": ["Религиозные объекты", "Социальные учреждения"], "Negozio": ["Объекты обслуживания"], "Gastronomo": ["Объекты обслуживания"], "Drogheria": ["Объекты обслуживания"], "Mercato": ["Объекты обслуживания"], "Bottega": ["Объекты обслуживания"], "Edicola, chiosco": ["Объекты обслуживания"], "chiosco": ["Объекты обслуживания"], "Padiglione": ["Объекты обслуживания"], "Panificio": ["Объекты обслуживания"], "Panetteria": ["Объекты обслуживания"], "Farmacia": ["Объекты обслуживания"], "Pescheria": ["Объекты обслуживания"], "caseificio": ["Объекты обслуживания"], "emporio": ["Объекты обслуживания"], "galleria": ["Объекты обслуживания", "Объекты культуры"], "centro commerciale": ["Объекты обслуживания"], "banco": ["Объекты обслуживания"], "Posta": ["Объекты обслуживания"], "Gastronomia": ["Объекты обслуживания"], "Accademia": ["Объекты науки и образования"], "College": ["Объекты науки и образования"], "collegio": ["Объекты науки и образования"], "Scuola": ["Объекты науки и образования"], "Istituto": ["Объекты науки и образования"], "Ginnasio": ["Объекты науки и образования"], "Università": ["Объекты науки и образования"], "Liceo": ["Объекты науки и образования"], "Conservatorio": ["Объекты науки и образования"], "Scuola materna": ["Объекты науки и образования"], "universita": ["Объекты науки и образования"], "Osservatorio": ["Объекты науки и образования"], "Laboratorio": ["Объекты науки и образования"], "facolta": ["Объекты науки и образования"], "universitario": ["Объекты науки и образования"], "school": ["Объекты науки и образования"], "lab": ["Объекты науки и образования"], "convitto": ["Объекты науки и образования"], "istsperimentale": ["Объекты науки и образования"], "building": ["Объекты науки и образования"], "Bar": ["Объекты общепита"], "Birreria": ["Объекты общепита"], "Caffetteria": ["Объекты общепита"], "Ristorante": ["Объекты общепита"], "Mensa": ["Объекты общепита"], "trattoria": ["Объекты общепита"], "Bettola": ["Объекты общепита"], "caffé": ["Объекты общепита"], "fiaschetteria": ["Объекты общепита"], "alfredo": ["Объекты общепита"], "osteria": ["Объекты общепита"], "Cinema": ["Объекты культуры"], "Teatro": ["Объекты культуры"], "Centro culturale": ["Объекты культуры"], "Casa della cultura": ["Объекты культуры"], "Sala concerti": ["Объекты культуры"], "Club": ["Объекты культуры"], "casotto": ["Объекты культуры"], "circo": ["Объекты культуры"], "casino": ["Объекты культуры"], "auditorium": ["Объекты культуры"], "cinematografia": ["Объекты культуры"], "acquario": ["Объекты культуры"], "dellesposizione": ["Объекты культуры"], "pinacoteca": ["Объекты культуры"], "Museo": ["Объекты культуры"], "Archivio": ["Объекты культуры"], "Biblioteca": ["Объекты культуры"], "galeria": ["Объекты культуры"], "tabularium": ["Объекты культуры"], "librario": ["Объекты культуры"], "antiquarium": ["Объекты культуры"], "archiviare": ["Объекты культуры"], "fortezzuola": ["Объекты культуры"], "crypta": ["Объекты культуры"], "Albergo": ["Гостиницы"], "Hotel": ["Гостиницы"], "Ministero": ["Административные объекты"], "Palazzo": ["Административные объекты"], "Gestione": ["Административные объекты"], "palazzetto": ["Административные объекты"], "cassia": ["Административные объекты"], "stabile": ["Административные объекты"], "associazione": ["Административные объекты"], "dipartimento": ["Административные объекты"], "cassare": ["Административные объекты"], "commissariare": ["Административные объекты"], "edilizio": ["Административные объекты"], "ambasciata": ["Административные объекты"], "denominazione": ["Административные объекты"], "dogana": ["Административные объекты"], "consorziare": ["Административные объекты"], "ufficio": ["Административные объекты"], "prefetto": ["Административные объекты"], "casa": ["Жилые дома"], "possedimento": ["Жилые дома"], "palazzina": ["Жилые дома"], "casetta": ["Жилые дома"], "manica": ["Жилые дома"], "caseggiato": ["Жилые дома"], "podere": ["Жилые дома"], "castello": ["Жилые дома"], "dependances": ["Жилые дома"], "villa": ["Жилые дома"], "capanna": ["Жилые дома"], "domus": ["Жилые дома"], "fattoria": ["Жилые дома"], "azienda agricola": ["Жилые дома"], "casone": ["Жилые дома"], "villino": ["Жилые дома"], "villetta": ["Жилые дома"], "abitazione": ["Жилые дома"], "pamphili": ["Жилые дома"], "tiburtino": ["Жилые дома"], "foresteria": ["Жилые дома"], "casina": ["Жилые дома"], "immobiliare": ["Жилые дома"], "residence": ["Жилые дома"], "castel": ["Жилые дома"], "casamento": ["Жилые дома"], "chalet": ["Жилые дома"], "casale": ["Жилые дома"], "residenziale": ["Жилые дома"], "magistero": ["Жилые дома"], "cascina": ["Жилые дома"], "Ospedale": ["Объекты здравоохранения"], "Sanatorio": ["Объекты здравоохранения"], "ospedaletto": ["Объекты здравоохранения"], "policlinico": ["Объекты здравоохранения"], "aulire": ["Объекты здравоохранения"], "stuart": ["Объекты здравоохранения"], "Porta": ["Объекты транспорта"], "Piattaforma": ["Транспортные сооружения"], "Stazione": ["Транспортные сооружения"], "portare": ["Объекты транспорта"], "porto": ["Объекты транспорта"], "aeroporto": ["Объекты транспорта"], "casello": ["Объекты транспорта"], "autoparco": ["Объекты транспорта"], "faro": ["Объекты транспорта"], "cantiere aeronautico": ["Объекты транспорта"], "Fabbrica": ["Промышленные объекты"], "Officina": ["Промышленные объекты", "Интерьеры"], "Produzione": ["Промышленные объекты"], "Manifattura": ["Промышленные объекты"], "Birrificio": ["Промышленные объекты"], "meccanico": ["Промышленные объекты"], "depuratore": ["Промышленные объекты"], "stabilimento": ["Промышленные объекты"], "cantiere navale": ["Промышленные объекты"], "fabbricare": ["Промышленные объекты"], "manifatturare": ["Промышленные объекты"], "fabbricato": ["Промышленные объекты"], "industriare": ["Промышленные объекты"], "pastificio": ["Промышленные объекты"], "Banca": ["Банки и биржи"], "Borsa": ["Банки и биржи"], "Magazzino": ["Складские объекты"], "granaio": ["Складские объекты"], "hangar": ["Складские объекты"], "barchessa": ["Складские объекты"], "cisterna": ["Складские объекты"], "deposito": ["Складские объекты"], "depositare": ["Складские объекты"], "capannone": ["Складские объекты"], "Fortezza": ["Военные объекты"], "carcere": ["Военные объекты"], "pretorio": ["Военные объекты"], "rocca": ["Военные объекты"], "Prigione": ["Военные объекты"], "Caserma": ["Военные объекты"], "chiusa": ["Военные объекты"], "forte": ["Военные объекты"], "arsenale": ["Военные объекты"], "casamatta": ["Военные объекты"], "Ippodromo": ["Спортивные сооружения"], "Palestra": ["Спортивные сооружения"], "stadio": ["Спортивные сооружения"], "circolo": ["Спортивные сооружения"], "campo": ["Спортивные сооружения"], "circolo sportivo": ["Спортивные сооружения"], "sportivo": ["Спортивные сооружения"], "campo sportivo": ["Спортивные сооружения"], "olimpico": ["Спортивные сооружения"], "velodromo": ["Спортивные сооружения"], "rostro": ["Спортивные сооружения"], "orfanotrofio": ["Социальные учреждения"], "pensione": ["Социальные учреждения"], "asilo nido": ["Социальные учреждения"], "Studio": ["Интерьеры"], "Servizio": ["Интерьеры"], "studiare": ["Интерьеры"], "appartamento": ["Интерьеры"], "ferrovia": ["Транспортные сооружения"], "stradale": ["Транспортные сооружения"], "tunnel": ["Транспортные сооружения"], "cavalcavia": ["Транспортные сооружения"], "ponte": ["Транспортные сооружения"], "molo": ["Транспортные сооружения"], "pontile": ["Транспортные сооружения"], "viadotto": ["Транспортные сооружения"], "pons": ["Транспортные сооружения"], "correre": ["Транспортные сооружения"], "Doria": ["Транспортные сооружения"], "pietralata": ["Транспортные сооружения"], "dock": ["Транспортные сооружения"], "torre": ["Инженерные сооружения "], "arco": ["Инженерные сооружения "], "acquedotto": ["Инженерные сооружения "], "garitta": ["Инженерные сооружения "], "canale": ["Инженерные сооружения "], "anfiteatro": ["Инженерные сооружения "], "struttura": ["Инженерные сооружения "], "dellacquedotto": ["Инженерные сооружения "], "carburare": ["Инженерные сооружения "], "catacomba": ["Инженерные сооружения "], "serbatoio": ["Инженерные сооружения "], "diga": ["Инженерные сооружения "], "dongione": ["Инженерные сооружения "], "cassero": ["Инженерные сооружения "], "parcare": ["Инженерные сооружения "], "bastione": ["Инженерные сооружения "], "marmo": ["Инженерные сооружения "], "gazometri": ["Инженерные сооружения "], "pozzo": ["Инженерные сооружения "], "catacombe": ["Инженерные сооружения "], "criptoportico": ["Инженерные сооружения "], "fornace": ["Инженерные сооружения "], "fortificazione": ["Оборонительные сооружения"], "campo militare": ["Оборонительные сооружения"], "fossato": ["Оборонительные сооружения"], "Bunker": ["Оборонительные сооружения"], "cimitero": ["Пусто"], "un parco": ["Пусто"], "giardini": ["Пусто"], "parchi": ["Пусто"], "cortile": ["Пусто"], "giardino": ["Пусто"], "orto": ["Пусто"], "oliveto": ["Пусто"], "bosco": ["Пусто"], "parco": ["Пусто"], "decollare": ["Пусто"], "roseto": ["Пусто"], "Parchigiardini": ["Пусто"], "riserva": ["Ансамбли и Территории исторической застройки"], "campo di battaglia": ["Ансамбли и Территории исторической застройки"], "beni paesaggistici": ["Ансамбли и Территории исторической застройки"], "nucleo storico": ["Ансамбли и Территории исторической застройки"], "quartiere": ["Ансамбли и Территории исторической застройки"], "testaccio": ["Ансамбли и Территории исторической застройки"], "piazzare": ["Ансамбли и Территории исторической застройки"], "area naturale protetta": ["Ансамбли и Территории исторической застройки"], "piano paesaggistico": ["Ансамбли и Территории исторической застройки"], "strada": ["Ансамбли и Территории исторической застройки"], "piazza": ["Ансамбли и Территории исторической застройки"], "colonia": ["Ансамбли и Территории исторической застройки"], "insediamento sparso": ["Ансамбли и Территории исторической застройки"], "via": ["Ансамбли и Территории исторической застройки"], "piazzale": ["Ансамбли и Территории исторической застройки"], "lungomare": ["Ансамбли и Территории исторической застройки"], "insula": ["Ансамбли и Территории исторической застройки"], "area": ["Ансамбли и Территории исторической застройки"], "capitolium": ["Ансамбли и Территории исторической застройки"], "borgo": ["Ансамбли и Территории исторической застройки"], "terreno": ["Ансамбли и Территории исторической застройки"], "isolare": ["Ансамбли и Территории исторической застройки"], "basolato": ["Ансамбли и Территории исторической застройки"], "porzione": ["Ансамбли и Территории исторической застройки"], "viale": ["Ансамбли и Территории исторической застройки"], "rimettere": ["Ансамбли и Территории исторической застройки"], "casal": ["Ансамбли и Территории исторической застройки"], "salire": ["Ансамбли и Территории исторической застройки"], "pace": ["Ансамбли и Территории исторической застройки"], "largire": ["Ансамбли и Территории исторической застройки"], "lungotevere": ["Ансамбли и Территории исторической застройки"], "passetto": ["Ансамбли и Территории исторической застройки"], "porticio": ["Ансамбли и Территории исторической застройки"], "quadriportico": ["Ансамбли и Территории исторической застройки"], "impiantire": ["Ансамбли и Территории исторической застройки"], "monte": ["Ансамбли и Территории исторической застройки"], "centrare": ["Ансамбли и Территории исторической застройки"], "appio": ["Ансамбли и Территории исторической застройки"], "lanza": ["Ансамбли и Территории исторической застройки"], "garbatella": ["Ансамбли и Территории исторической застройки"], "cordonata": ["Ансамбли и Территории исторической застройки"], "borghetto": ["Ансамбли и Территории исторической застройки"], "passeggiare": ["Ансамбли и Территории исторической застройки"], "borgata": ["Ансамбли и Территории исторической застройки"], "vicolo": ["Ансамбли и Территории исторической застройки"], "sagata": ["Ансамбли и Территории исторической застройки"], "crescenzio": ["Ансамбли и Территории исторической застройки"], "campire": ["Ансамбли и Территории исторической застройки"], "torraccia": ["Ансамбли и Территории исторической застройки"], "tridente": ["Ансамбли и Территории исторической застройки"], "panorama": ["Ансамбли и Территории исторической застройки"], "quarticciolo": ["Ансамбли и Территории исторической застройки"], "molare": ["Ансамбли и Территории исторической застройки"], "pantaleo": ["Ансамбли и Территории исторической застройки"], "lottare": ["Ансамбли и Территории исторической застройки"], "monumento": ["Пустое"], "calcolo": ["Пустое"], "statua": ["Пустое"], "bagni": ["Пустое"], "tomba": ["Пустое"], "obelisco": ["Пустое"], "scultura": ["Пустое"], "altare": ["Пустое"], "stele": ["Пустое"], "sollievo": ["Пустое"], "ninfeo": ["Пустое"], "tabernacolo": ["Пустое"], "sepolcro": ["Пустое"], "schola": ["Пустое"], "forare": ["Пустое"], "mitreo": ["Пустое"], "sede": ["Пустое"], "fullonica": ["Пустое"], "cdtomba": ["Пустое"], "fratello": ["Пустое"], "sepolcreto": ["Пустое"], "monticelli": ["Пустое"], "pacis": ["Пустое"], "parrocchiale": ["Пустое"], "berretta": ["Пустое"], "sacrario": ["Пустое"], "copiare": ["Пустое"], "minerva": ["Пустое"], "tempo": ["Пустое"], "orologio": ["Пустое"], "horologium": ["Пустое"], "muro": ["Пустое"], "bagno": ["Пустое"], "recinzione": ["Пустое"], "ringhiera": ["Пустое"], "ascensore": ["Пустое"], "fontanone": ["Пустое"], "bacino": ["Пустое"], "parete": ["Пустое"], "fontana": ["Пустое"], "criptare": ["Пустое"], "fontanella": ["Пустое"], "portale": ["Пустое"], "portico": ["Пустое"], "scalea": ["Пустое"], "loggia": ["Пустое"], "colonnare": ["Пустое"], "colonna": ["Пустое"], "portone": ["Пустое"], "facciata": ["Пустое"], "scalare": ["Пустое"], "propilei": ["Пустое"], "porticus": ["Пустое"], "scalinare": ["Пустое"], "stanza": ["Пустое"], "tor": ["Пустое"], "norancia": ["Пустое"], "loggetta": ["Пустое"], "palmassimo": ["Пустое"], "lapide": ["Пустое"], "masenza": ["Пустое"], "colonnacce": ["Пустое"], "porticato": ["Пустое"], "arcuazioni": ["Пустое"], "cavo": ["Пустое"], "scalone": ["Пустое"], "finestra": ["Пустое"], "fondazione": ["Пустое"], "rampa": ["Пустое"], "gazebo": ["Пустое"], "marciapiede": ["Пустое"], "grotta": ["Пустое"], "terrapieno": ["Пустое"], "belvedere": ["Пустое"], "inseime": ["Пустое"], "catalogare": ["Пустое"], "edificio": ["Пустое"], "sito": ["Пустое"], "mausoleo": ["Пустое"], "colombaia": ["Пустое"], "mattatoio": ["Пустое"], "Architettura": ["Пустое"], "Monumenti archeologici": ["Пустое"], "Complessi archeologici": ["Пустое"], "Siti archeologici": ["Пустое"], "riserve": ["Ансамбли и Территории исторической застройки"], "rischi": ["Ансамбли и Территории исторической застройки"], "rischio": ["Ансамбли и Территории исторической застройки"], "vincoli": ["Ансамбли и Территории исторической застройки"], "vincolo": ["Ансамбли и Территории исторической застройки"]}
unusable_dict_types = {"acropoli": ["Археология"], "nido": ["Здания"], "autostazione": ["Сооружения"], "azienda": ["Здания"], "banchina": ["Разное"], "basamento": ["Архитектурный элемент"], "castelliere": ["Здания"], "centrale": ["Здания"], "fortificativa": ["Здания"], "luogo": ["Здания"], "masseria": ["Здания"], "posto": ["Здания"], "rifugiare": ["Здания"], "murario": ["Архитектурный элемент"], "taverna": ["Здания"], "viario": ["Городской ландшафт"], "trullo": ["Здания"], "universit": ["Здания"], "villaggio": ["Городской ландшафт"], "zecca": ["Здания"], "ospizio": ["Здания"], "basilico": ["Здания"], "cascia": ["Здания"], "orefice": ["Здания"], "sapere": ["Здания"], "salare": ["Здания"], "stefano": ["Здания"], "sstefano": ["Здания"], "sandrea": ["Здания"], "ssandrea": ["Здания"], "scaterina": ["Здания"], "corsini": ["Здания"], "sciriaca": ["Здания"], "spezieria": ["Здания"], "ufficiare": ["Здания"], "edicola": ["Здания"], "ateneo": ["Здания"], "coffee": ["Здания"], "caffeehaus": ["Здания"], "locale": ["Здания"], "caffo": ["Здания"], "casilino": ["Здания"], "inps": ["Здания"], "mibact": ["Здания"], "campionario": ["Здания"], "termoelettrico": ["Здания"], "biblnazionale": ["Здания"], "carabiniere": ["Здания"], "militare ": ["Здания"], "scuderia": ["Здания"], "stalla": ["Здания"], "salone": ["Здания"], "filippo": ["Здания"], "ssgiovanni": ["Здания"], "montesanto": ["Здания"], "tolentino": ["Здания"], "cd": ["Здания"], "robertini": ["Здания"], "mazzalupetto": ["Сады и парки"], "complesso": ["Городской ландшафт"], "necropoli": ["Монумент / памятник"], "archeologico": ["Археология"], "resto": ["Археология"], "insediamento": ["Археология"], "avanzo": ["Археология"], "costruzione": ["Археология"], "cloaca": ["Археология"], "horrea": ["Археология"], "terme": ["Археология"], "caupona": ["Археология"], "macellum": ["Археология"], "tabernae": ["Археология"], "thermopolium": ["Археология"], "maximus": ["Археология"], "sacello": ["Археология"], "scavo": ["Археология"], "vicus": ["Археология"], "veio": ["Археология"], "ipogeo": ["Археология"], "citta": ["Археология"], "immobile": ["Археология"], "muraglia": ["Археология"], "abitare": ["Археология"], "blocco": ["Археология"], "excubitorium": ["Археология"], "saepta": ["Археология"], "colombario": ["Археология"], "piramide": ["Археология"], "clivo": ["Археология"], "campidoglio": ["Археология"], "vulcano": ["Археология"], "murare": ["Археология"], "paedagogium": ["Археология"], "rampare": ["Археология"], "terrazzare": ["Археология"], "fonte": ["Археология"], "emiciclo": ["Археология"], "triclinio": ["Археология"], "regio": ["Археология"], "torrione": ["Археология"], "templum": ["Археология"], "traforo": ["Археология"], "ludus": ["Археология"], "colombari": ["Археология"], "rudere": ["Археология"], "trofeo": ["Археология"], "ambulacro": ["Археология"], "giacimento": ["Археология"], "fidenae": ["Археология"], "fortificare": ["Археология"], "gabii": ["Археология"], "Chiesa": ["Здания"], "convento": ["Здания"], "Monastero": ["Здания"], "Tempio": ["Здания"], "Cappella": ["Здания"], "cenobio": ["Здания"], "chiesetta": ["Здания"], "Cattedrale": ["Здания"], "Moschea": ["Здания"], "Campanile": ["Здания"], "Refettorio": ["Здания"], "canonica": ["Здания"], "sinagoga": ["Здания"], "abbazia": ["Здания"], "basilica": ["Здания"], "collegiata": ["Здания"], "battistero": ["Здания"], "beghinaggio": ["Здания"], "cella": ["Здания"], "regina": ["Здания"], "marcellino": ["Здания"], "scesareo": ["Здания"], "tempietto": ["Здания"], "curia": ["Здания"], "certosa": ["Здания"], "santuario": ["Здания"], "exchiesa": ["Здания"], "Oratorio": ["Здания"], "pantheon": ["Здания"], "canonico": ["Здания"], "campitelli": ["Здания"], "silvestro": ["Здания"], "chiostro": ["Здания"], "immacolato": ["Здания"], "sagrestia": ["Здания"], "antisagrestia": ["Здания"], "rotondo": ["Здания"], "exconvento": ["Здания"], "Negozio": ["Здания"], "Gastronomo": ["Здания"], "Drogheria": ["Здания"], "Mercato": ["Здания"], "Bottega": ["Здания"], "Edicola, chiosco": ["Здания"], "chiosco": ["Здания"], "Padiglione": ["Здания"], "Panificio": ["Здания"], "Panetteria": ["Здания"], "Farmacia": ["Здания"], "Pescheria": ["Здания"], "caseificio": ["Здания"], "emporio": ["Здания"], "centro commerciale": ["Здания"], "banco": ["Здания"], "Posta": ["Здания"], "Gastronomia": ["Здания"], "Accademia": ["Здания"], "College": ["Здания"], "collegio": ["Здания"], "Scuola": ["Здания"], "Istituto": ["Здания"], "Ginnasio": ["Здания"], "Università": ["Здания"], "Liceo": ["Здания"], "Conservatorio": ["Здания"], "Scuola materna": ["Здания"], "universita": ["Здания"], "Osservatorio": ["Здания"], "Laboratorio": ["Здания"], "facolta": ["Здания"], "universitario": ["Здания"], "school": ["Здания"], "lab": ["Здания"], "convitto": ["Здания"], "istsperimentale": ["Здания"], "building": ["Здания"], "Bar": ["Здания"], "Birreria": ["Здания"], "Caffetteria": ["Здания"], "Ristorante": ["Здания"], "Mensa": ["Здания"], "trattoria": ["Здания"], "Bettola": ["Здания"], "caffé": ["Здания"], "fiaschetteria": ["Здания"], "alfredo": ["Здания"], "osteria": ["Здания"], "Cinema": ["Здания"], "Galleria": ["Здания"], "Teatro": ["Здания"], "Centro culturale": ["Здания"], "Casa della cultura": ["Здания"], "Sala concerti": ["Здания"], "Club": ["Здания"], "casotto": ["Здания"], "circo": ["Здания"], "casino": ["Здания"], "auditorium": ["Здания"], "cinematografia": ["Здания"], "acquario": ["Здания"], "dellesposizione": ["Здания"], "pinacoteca": ["Здания"], "Museo": ["Здания"], "Archivio": ["Здания"], "Biblioteca": ["Здания"], "galeria": ["Здания"], "tabularium": ["Здания"], "librario": ["Здания"], "antiquarium": ["Здания"], "archiviare": ["Здания"], "fortezzuola": ["Здания"], "crypta": ["Здания"], "Albergo": ["Здания"], "Hotel": ["Здания"], "Ministero": ["Здания"], "Palazzo": ["Здания"], "Gestione": ["Здания"], "palazzetto": ["Здания"], "cassia": ["Здания"], "stabile": ["Здания"], "associazione": ["Здания"], "dipartimento": ["Здания"], "cassare": ["Здания"], "commissariare": ["Здания"], "edilizio": ["Здания"], "ambasciata": ["Здания"], "denominazione": ["Здания"], "dogana": ["Здания"], "consorziare": ["Здания"], "ufficio": ["Здания"], "prefetto": ["Здания"], "casa": ["Здания"], "possedimento": ["Здания"], "palazzina": ["Здания"], "casetta": ["Здания"], "manica": ["Здания"], "caseggiato": ["Здания"], "podere": ["Здания"], "castello": ["Здания"], "dependances": ["Здания"], "villa": ["Здания"], "capanna": ["Здания"], "domus": ["Здания"], "fattoria": ["Здания"], "azienda agricola": ["Здания"], "casone": ["Здания"], "villino": ["Здания"], "villetta": ["Здания"], "abitazione": ["Здания"], "pamphili": ["Здания"], "tiburtino": ["Здания"], "foresteria": ["Здания"], "casina": ["Здания"], "immobiliare": ["Здания"], "residence": ["Здания"], "castel": ["Здания"], "casamento": ["Здания"], "chalet": ["Здания"], "casale": ["Здания"], "residenziale": ["Здания"], "magistero": ["Здания"], "cascina": ["Здания"], "Ospedale": ["Здания"], "Sanatorio": ["Здания"], "ospedaletto": ["Здания"], "policlinico": ["Здания"], "aulire": ["Здания"], "stuart": ["Здания"], "Porta": ["Здания"], "Piattaforma": ["Сооружения"], "Stazione": ["Сооружения"], "portare": ["Здания"], "porto": ["Здания"], "aeroporto": ["Здания"], "casello": ["Здания"], "autoparco": ["Здания"], "faro": ["Здания"], "cantiere aeronautico": ["Здания"], "Fabbrica": ["Здания"], "Officina": ["Здания"], "Produzione": ["Здания"], "Manifattura": ["Здания"], "Birrificio": ["Здания"], "meccanico": ["Здания"], "depuratore": ["Здания"], "stabilimento": ["Здания"], "cantiere navale": ["Здания"], "fabbricare": ["Здания"], "manifatturare": ["Здания"], "fabbricato": ["Здания"], "industriare": ["Здания"], "pastificio": ["Здания"], "Banca": ["Здания"], "Borsa": ["Здания"], "Magazzino": ["Здания"], "granaio": ["Здания"], "hangar": ["Здания"], "barchessa": ["Здания"], "cisterna": ["Здания"], "deposito": ["Здания"], "depositare": ["Здания"], "capannone": ["Здания"], "Fortezza": ["Здания"], "carcere": ["Здания"], "pretorio": ["Здания"], "rocca": ["Здания"], "Prigione": ["Здания"], "Caserma": ["Здания"], "chiusa": ["Здания"], "forte": ["Здания"], "arsenale": ["Здания"], "casamatta": ["Здания"], "Ippodromo": ["Сооружения"], "Palestra": ["Сооружения"], "stadio": ["Сооружения"], "circolo": ["Сооружения"], "campo": ["Сооружения"], "circolo sportivo": ["Сооружения"], "sportivo": ["Сооружения"], "campo sportivo": ["Сооружения"], "olimpico": ["Сооружения"], "velodromo": ["Сооружения"], "rostro": ["Сооружения"], "orfanotrofio": ["Здания"], "pensione": ["Здания"], "asilo nido": ["Здания"], "Officina": ["Здания"], "Studio": ["Здания"], "Servizio": ["Здания"], "studiare": ["Здания"], "appartamento": ["Здания"], "ferrovia": ["Сооружения"], "stradale": ["Сооружения"], "tunnel": ["Сооружения"], "cavalcavia": ["Сооружения"], "ponte": ["Сооружения"], "molo": ["Сооружения"], "pontile": ["Сооружения"], "viadotto": ["Сооружения"], "pons": ["Сооружения"], "correre": ["Сооружения"], "Doria": ["Сооружения"], "pietralata": ["Сооружения"], "dock": ["Сооружения"], "torre": ["Сооружения"], "arco": ["Сооружения"], "acquedotto": ["Сооружения"], "garitta": ["Сооружения"], "canale": ["Сооружения"], "anfiteatro": ["Сооружения"], "struttura": ["Сооружения"], "dellacquedotto": ["Сооружения"], "carburare": ["Сооружения"], "catacomba": ["Сооружения"], "serbatoio": ["Сооружения"], "diga": ["Сооружения"], "dongione": ["Сооружения"], "cassero": ["Сооружения"], "parcare": ["Сооружения"], "bastione": ["Сооружения"], "marmo": ["Сооружения"], "gazometri": ["Сооружения"], "pozzo": ["Сооружения"], "catacombe": ["Сооружения"], "criptoportico": ["Сооружения"], "fornace": ["Сооружения"], "fortificazione": ["Сооружения"], "campo militare": ["Сооружения"], "fossato": ["Сооружения"], "Bunker": ["Сооружения"], "cimitero": ["Сады и парки"], "un parco": ["Сады и парки"], "giardini": ["Сады и парки"], "parchi": ["Сады и парки"], "cortile": ["Сады и парки"], "giardino": ["Сады и парки"], "orto": ["Сады и парки"], "oliveto": ["Сады и парки"], "bosco": ["Сады и парки"], "parco": ["Сады и парки"], "decollare": ["Сады и парки"], "roseto": ["Сады и парки"], "Parchigiardini": ["Сады и парки"], "riserva": ["Городской ландшафт"], "campo di battaglia": ["Городской ландшафт"], "beni paesaggistici": ["Городской ландшафт"], "nucleo storico": ["Городской ландшафт"], "quartiere": ["Городской ландшафт"], "testaccio": ["Городской ландшафт"], "piazzare": ["Городской ландшафт"], "area naturale protetta": ["Городской ландшафт"], "piano paesaggistico": ["Городской ландшафт"], "strada": ["Городской ландшафт"], "piazza": ["Городской ландшафт"], "colonia": ["Городской ландшафт"], "insediamento sparso": ["Городской ландшафт"], "via": ["Городской ландшафт"], "piazzale": ["Городской ландшафт"], "lungomare": ["Городской ландшафт"], "insula": ["Городской ландшафт"], "area": ["Городской ландшафт"], "capitolium": ["Городской ландшафт"], "borgo": ["Городской ландшафт"], "terreno": ["Городской ландшафт"], "isolare": ["Городской ландшафт"], "basolato": ["Городской ландшафт"], "porzione": ["Городской ландшафт"], "viale": ["Городской ландшафт"], "rimettere": ["Городской ландшафт"], "casal": ["Городской ландшафт"], "salire": ["Городской ландшафт"], "pace": ["Городской ландшафт"], "largire": ["Городской ландшафт"], "lungotevere": ["Городской ландшафт"], "passetto": ["Городской ландшафт"], "porticio": ["Городской ландшафт"], "quadriportico": ["Городской ландшафт"], "impiantire": ["Городской ландшафт"], "monte": ["Городской ландшафт"], "centrare": ["Городской ландшафт"], "appio": ["Городской ландшафт"], "lanza": ["Городской ландшафт"], "garbatella": ["Городской ландшафт"], "cordonata": ["Городской ландшафт"], "borghetto": ["Городской ландшафт"], "passeggiare": ["Городской ландшафт"], "borgata": ["Городской ландшафт"], "vicolo": ["Городской ландшафт"], "sagata": ["Городской ландшафт"], "crescenzio": ["Городской ландшафт"], "campire": ["Городской ландшафт"], "torraccia": ["Городской ландшафт"], "tridente": ["Городской ландшафт"], "panorama": ["Городской ландшафт"], "quarticciolo": ["Городской ландшафт"], "molare": ["Городской ландшафт"], "pantaleo": ["Городской ландшафт"], "lottare": ["Городской ландшафт"], "monumento": ['Археология'], "calcolo": ["Монумент / памятник"], "statua": ["Монумент / памятник"], "bagni": ["Монумент / памятник"], "tomba": ["Монумент / памятник"], "obelisco": ["Монумент / памятник"], "scultura": ["Монумент / памятник"], "altare": ["Монумент / памятник"], "stele": ["Монумент / памятник"], "sollievo": ["Монумент / памятник"], "ninfeo": ["Монумент / памятник"], "tabernacolo": ["Монумент / памятник"], "sepolcro": ["Монумент / памятник"], "schola": ["Монумент / памятник"], "forare": ["Монумент / памятник"], "mitreo": ["Монумент / памятник"], "sede": ["Монумент / памятник"], "fullonica": ["Монумент / памятник"], "cdtomba": ["Монумент / памятник"], "fratello": ["Монумент / памятник"], "sepolcreto": ["Монумент / памятник"], "monticelli": ["Монумент / памятник"], "pacis": ["Монумент / памятник"], "parrocchiale": ["Монумент / памятник"], "berretta": ["Монумент / памятник"], "sacrario": ["Монумент / памятник"], "copiare": ["Монумент / памятник"], "minerva": ["Монумент / памятник"], "tempo": ["Монумент / памятник"], "orologio": ["Монумент / памятник"], "horologium": ["Монумент / памятник"], "muro": ["Монумент / памятник"], "bagno": ["Монумент / памятник"], "recinzione": ["Архитектурный элемент"], "ringhiera": ["Архитектурный элемент"], "ascensore": ["Архитектурный элемент"], "fontanone": ["Архитектурный элемент"], "bacino": ["Архитектурный элемент"], "parete": ["Архитектурный элемент"], "fontana": ["Архитектурный элемент"], "criptare": ["Архитектурный элемент"], "fontanella": ["Архитектурный элемент"], "portale": ["Архитектурный элемент"], "portico": ["Архитектурный элемент"], "scalea": ["Архитектурный элемент"], "loggia": ["Архитектурный элемент"], "colonnare": ["Архитектурный элемент"], "colonna": ["Архитектурный элемент"], "portone": ["Архитектурный элемент"], "facciata": ["Архитектурный элемент"], "scalare": ["Архитектурный элемент"], "propilei": ["Архитектурный элемент"], "porticus": ["Архитектурный элемент"], "scalinare": ["Архитектурный элемент"], "stanza": ["Архитектурный элемент"], "tor": ["Архитектурный элемент"], "norancia": ["Архитектурный элемент"], "loggetta": ["Архитектурный элемент"], "palmassimo": ["Архитектурный элемент"], "lapide": ["Архитектурный элемент"], "masenza": ["Архитектурный элемент"], "colonnacce": ["Архитектурный элемент"], "porticato": ["Архитектурный элемент"], "arcuazioni": ["Архитектурный элемент"], "cavo": ["Архитектурный элемент"], "scalone": ["Архитектурный элемент"], "finestra": ["Архитектурный элемент"], "fondazione": ["Архитектурный элемент"], "rampa": ["Разное"], "gazebo": ["Разное"], "marciapiede": ["Разное"], "grotta": ["Разное"], "terrapieno": ["Разное"], "belvedere": ["Разное"], "inseime": ["Разное"], "catalogare": ["Разное"], "edificio": ["Разное"], "sito": ["Разное"], "mausoleo": ["Разное"], "colombaia": ["Разное"], "mattatoio": ["Разное"], "Architettura": ["Здания и сооружения"], "Monumenti archeologici": ["Археология"], "Complessi archeologici": ["Археология"], "Siti archeologici": ["Археология"], "riserve": ["Городской ландшафт"], "rischi": ["Городской ландшафт"], "vincoli": ["Городской ландшафт"], "vincolo": ["Городской ландшафт"], "rischio": ["Городской ландшафт"]}
data = pd.read_excel(r'D:\Dev\Pycharm projects\okn\rome-beniculturali.xlsx')
df = pd.DataFrame(data, columns= ['Tipo bene_NEW', 'Tipo scheda'])


def update_dict(old_dict: dict):
    new_dict = {}

    for key in old_dict:
        new_key = key.lower()
        new_dict[new_key] = old_dict[key]

    return new_dict

dict_functions = update_dict(unusable_dict_functions)
dict_types = update_dict(unusable_dict_types)


df['alt_name1'] = ''
df['results_functions'] = ''
df['nlp_list1'] = ''

df['alt_name2'] = ''
df['nlp_list2'] = ''
df['results_types'] = ''

for index, row in df.iterrows():
    row['alt_name1'] = str(row['Tipo bene_NEW'])
    row['alt_name1'] = row['alt_name1'].lower()
    row['alt_name1'] = re.sub(r'[^a-zA-Z ]', '', row['alt_name1'])
    row['results_functions'] = []

    row['nlp_list1'] = []
    text = row['alt_name1']
    doc = nlp(text)
    for token in doc:
        if token.pos_ in ('NOUN', 'PROPN', 'ADV', 'ADJ', 'VERB') and len(token.lemma_) >= 2:
            row['nlp_list1'].append(token.lemma_)

    for key in row['nlp_list1']:
        if key in dict_functions:
            row['results_functions'].extend(dict_functions[key])

    row['results_functions'] = list(set(row['results_functions']))

    if not row['results_functions']:
        row['results_functions'] = ['None']

for index, row in df.iterrows():
    row['alt_name2'] = str(row['Tipo scheda'])
    row['alt_name2'] = row['alt_name2'].lower()
    row['alt_name2'] = re.sub(r'[^a-zA-Z ]', '', row['alt_name2'])
    row['results_types'] = []

    row['nlp_list2'] = []
    text = row['alt_name2']
    doc = nlp(text)
    for token in doc:
        if token.pos_ in ('NOUN', 'PROPN', 'ADV', 'ADJ', 'VERB') and len(token.lemma_) >= 2:
            row['nlp_list2'].append(token.lemma_)

    for key in row['nlp_list2']:
        if key in dict_types:
            row['results_types'].extend(dict_types[key])

    row['results_types'] = list(set(row['results_types']))

    if not row['results_types']:
        row['results_types'] = ['None']


df.to_excel(r'D:\Dev\Pycharm projects\okn\rome-beniculturali-output-1.xlsx', sheet_name='Sheet1', index = False)



