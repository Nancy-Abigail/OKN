# coding=UTF-8

import pandas as pd
import re
import spacy

nlp = spacy.load("fr_core_news_sm")

unusable_dict_functions = {"académie": ["Объекты науки и образования"], "saintechapell": ["Религиозные объекты"], "Gar": ["Объекты транспорта"], "abbay": ["Религиозные объекты"], "mosquer": ["Религиозные объекты"], "palai": ["Объекты обслуживания"], "boutiqu": ["Объекты обслуживания"], "pharmaci": ["Объекты обслуживания"], "Institut": ["Объекты науки и образования"], "collège": ["Объекты науки и образования"], "lycer": ["Объекты науки и образования"], "laboratoir": ["Объекты науки и образования"], "sorbonne": ["Объекты науки и образования"], "Immeuble": ["Жилые дома"], "restaurer": ["Объекты общепита"], "cafer": ["Объекты общепита"], "cirqu": ["Объекты культуры"], "muser": ["Объекты культуры"], "comédie": ["Объекты культуры"], "usin ": ["Промышленные объекты"], "chasse": ["Другое"], "tristan": ["Другое"], "spr": ["Пустое"], "amvap": ["Пустое"], "Église": ["Религиозные объекты"], "eglise": ["Религиозные объекты"], "Monastère": ["Религиозные объекты"], "Temple": ["Религиозные объекты"], "Chapelle": ["Религиозные объекты"], "prieuré": ["Религиозные объекты"], "couvent": ["Религиозные объекты"], "Cathédrale": ["Религиозные объекты"], "Mosquée": ["Религиозные объекты"], "Clocher": ["Религиозные объекты"], "Réfectoire": ["Религиозные объекты", "Объекты общепита"], "presbytère": ["Религиозные объекты"], "synagogue": ["Религиозные объекты"], "abbaye": ["Религиозные объекты"], "basilique": ["Религиозные объекты"], "collégiale": ["Религиозные объекты"], "croixautel": ["Религиозные объекты"], "cathédral": ["Религиозные объекты"], "noviciat": ["Религиозные объекты"], "Boutique": ["Объекты обслуживания"], "Marché": ["Объекты обслуживания"], "comptoir": ["Объекты обслуживания"], "Étal": ["Объекты обслуживания"], "Kiosque": ["Объекты обслуживания"], "Pavillon": ["Объекты обслуживания"], "Boulangerie": ["Объекты обслуживания"], "Pharmacie": ["Объекты обслуживания"], "poissonerie": ["Объекты обслуживания"], "crèmerie": ["Объекты обслуживания"], "boucherie": ["Объекты обслуживания"], "magasin": ["Объекты обслуживания"], "passage": ["Объекты обслуживания"], "débit": ["Объекты обслуживания"], "charcuterie": ["Объекты обслуживания"], "librairie": ["Объекты обслуживания"], "crémerieépicerie": ["Объекты обслуживания"], "boucheriecharcuterie": ["Объекты обслуживания"], "commerce": ["Объекты обслуживания"], "poissonnerie": ["Объекты обслуживания"], "Épicerie": ["Объекты обслуживания"], "epicerie": ["Объекты обслуживания"], "Courrier": ["Объекты обслуживания"], "Poste": ["Объекты обслуживания"], "téléphonique": ["Объекты обслуживания"], "Imprimerie": ["Объекты обслуживания"], "centrale téléphonique": ["Объекты обслуживания"], "bain": ["Объекты обслуживания"], "bains": ["Объекты обслуживания"], "lavoir": ["Объекты обслуживания"], "mobilier": ["Объекты обслуживания"], "Gymnase": ["Спортивные сооружения"], "Université": ["Объекты науки и образования"], "Lycée": ["Объекты науки и образования"], "Conservatoire": ["Объекты науки и образования"], "garderie": ["Объекты науки и образования"], "Jardin d'enfants": ["Объекты науки и образования"], "observatoir": ["Объекты науки и образования"], "Observatoire": ["Объекты науки и образования"], "laboratoire": ["Объекты науки и образования"], "faculté de médecine": ["Объекты науки и образования"], "ecole": ["Объекты науки и образования"], "faculté": ["Объекты науки и образования"], "groupe scolaire": ["Объекты науки и образования"], "scolaire": ["Объекты науки и образования"], "sarbonne": ["Объекты науки и образования"], "office": ["Объекты науки и образования"], "Bar": ["Объекты общепита"], "Brasserie": ["Объекты общепита"], "Café": ["Объекты общепита"], "caféconcert": ["Объекты общепита", "Объекты культуры"], "Restaurant": ["Объекты общепита"], "Salle à manger": ["Объекты общепита"], "Taverne": ["Объекты общепита"], "Cabaret": ["Объекты общепита", "Объекты культуры"], "clownbar": ["Объекты общепита"], "boulangeriepâtisserie": ["Объекты общепита"], "boulangeriepâtisserieconfiserie": ["Объекты общепита"], "cafe": ["Объекты общепита"], "cafébar": ["Объекты общепита"], "barrestaurant": ["Объекты общепита"], "pâtisserie": ["Объекты общепита"], "confiserie": ["Объекты общепита"], "coffee house": ["Объекты общепита"], "crémerie": ["Объекты общепита"], "Cinéma": ["Объекты культуры"], "Galerie": ["Объекты культуры"], "Théâtre": ["Объекты культуры"], "Centre culturel": ["Объекты культуры"], "Maison de la culture": ["Объекты культуры"], "cinémer": ["Объекты культуры"], "Salle de concert": ["Объекты культуры"], "Club": ["Объекты культуры"], "casino": ["Объекты культуры"], "Salle": ["Объекты культуры"], "Cercle": ["Объекты культуры"], "Arène": ["Объекты культуры"], "Musée": ["Объекты культуры"], "Archive": ["Объекты культуры"], "Bibliothèque": ["Объекты культуры"], "bibliothèqu": ["Объекты культуры"], "Hôtel": ["Гостиницы"], "chambre": ["Гостиницы"], "carmel": ["Гостиницы"], "Ministère": ["Административные объекты"], "Palais": ["Административные объекты"], "Service": ["Административные объекты"], "Siège": ["Административные объекты"], "caisse": ["Административные объекты"], "préfecture": ["Административные объекты"], "tribunal": ["Административные объекты"], "mairie": ["Административные объекты"], "palace": ["Административные объекты"], "hôtel de ville": ["Административные объекты"], "Fondation": ["Административные объекты"], "résidence": ["Жилые дома"], "demeure": ["Жилые дома"], "maison": ["Жилые дома"], "ensemble": ["Жилые дома"], "manoir": ["Жилые дома"], "château": ["Жилые дома"], "datcha": ["Жилые дома"], "aile": ["Жилые дома"], "villa": ["Жилые дома"], "cour": ["Жилые дома"], "cabane": ["Жилые дома"], "domaine": ["Жилые дома"], "viller": ["Жилые дома"], "ferme": ["Жилые дома"], "maisonatelier": ["Жилые дома"], "bateau": ["Жилые дома"], "Folie": ["Жилые дома"], "logement": ["Жилые дома"], "propriéter": ["Жилые дома"], "propriété": ["Жилые дома"], "chateau": ["Жилые дома"], "chalet": ["Жилые дома"], "foyer": ["Жилые дома"], "logis seigneurial": ["Жилые дома"], "dépendance": ["Жилые дома"], "Hôpital": ["Объекты здравоохранения"], "Sanatorium": ["Объекты здравоохранения"], "hopital": ["Объекты здравоохранения"], "Port": ["Объекты транспорта"], "Plateforme": ["Транспортные сооружения"], "Gare": ["Объекты транспорта"], "Station": ["Транспортные сооружения"], "aérogare": ["Объекты транспорта"], "aéroport": ["Объекты транспорта"], "ceinture": ["Объекты транспорта"], "Usine": ["Промышленные объекты"], "Atelier": ["Промышленные объекты", "Интерьеры"], "Production": ["Промышленные объекты"], "Manufacture": ["Промышленные объекты"], "Microbrasserie": ["Промышленные объекты"], "fabrique": ["Промышленные объекты"], "porcelainerie": ["Промышленные объекты"], "horlogerie": ["Промышленные объекты"], "Banque": ["Банки и биржи"], "Bourse": ["Банки и биржи"], "Bours": ["Банки и биржи"], "Forteresse": ["Военные объекты"], "Tor": ["Военные объекты"], "Prison": ["Военные объекты"], "Caserne": ["Военные объекты"], "citérefuge": ["Военные объекты"], "Entrepôt": ["Складские объекты"], "dépôt": ["Складские объекты"], "grange": ["Складские объекты"], "hangar": ["Складские объекты"], "Hippodrome": ["Спортивные сооружения"], "piscine": ["Спортивные сооружения"], "stade": ["Спортивные сооружения"], "jeu": ["Спортивные сооружения"], "orphelinat": ["Социальные учреждения"], "hospic": ["Социальные учреждения"], "hospice": ["Социальные учреждения"], "asile": ["Социальные учреждения"], "Studio": ["Интерьеры"], "Bureau": ["Интерьеры"], "appartement": ["Интерьеры"], "chemin de fer": ["Транспортные сооружения"], "tunnel": ["Транспортные сооружения"], "estacade": ["Транспортные сооружения"], "pont": ["Транспортные сооружения"], "jetée": ["Транспортные сооружения"], "viaduc": ["Транспортные сооружения"], "pontlever": ["Транспортные сооружения"], "pontroyal": ["Транспортные сооружения"], "pontneuf": ["Транспортные сооружения"], "passerell": ["Транспортные сооружения"], "quai": ["Транспортные сооружения"], "métropolitain": ["Транспортные сооружения"], "tour": ["Инженерные сооружения"], "arc": ["Инженерные сооружения"], "guérite": ["Инженерные сооружения"], "canal": ["Инженерные сооружения"], "amphithéâtre": ["Инженерные сооружения"], "sousstation": ["Инженерные сооружения"], "aqueduc": ["Инженерные сооружения"], "moulin": ["Инженерные сооружения"], "belleville": ["Инженерные сооружения"], "chaudron": ["Инженерные сооружения"], "bastion": ["Инженерные сооружения"], "donjon": ["Инженерные сооружения"], "bernage": ["Инженерные сооружения"], "souffleri": ["Инженерные сооружения"], "fort": ["Оборонительные сооружения"], "douve": ["Оборонительные сооружения"], "Bunker": ["Оборонительные сооружения"], "cimitière": ["Пусто"], "parc": ["Пусто"], "jardin": ["Пусто"], "bois": ["Пусто"], "cimetière": ["Пусто"], "roseraie": ["Пусто"], "réserve": ["Ансамбли и Территории исторической застройки"], "champ de bataille": ["Ансамбли и Территории исторической застройки"], "paysage": ["Ансамбли и Территории исторической застройки"], "site classé": ["Ансамбли и Территории исторической застройки"], "site": ["Ансамбли и Территории исторической застройки"], "site inscrit": ["Ансамбли и Территории исторической застройки"], "site patrimonial remarquable": ["Ансамбли и Территории исторической застройки"], "plan de sauvegarde et de mise en valeur": ["Ансамбли и Территории исторической застройки"], "Square": ["Ансамбли и Территории исторической застройки"], "allée": ["Ансамбли и Территории исторической застройки"], "cité": ["Ансамбли и Территории исторической застройки"], "ilôt": ["Ансамбли и Территории исторической застройки"], "Place": ["Ансамбли и Территории исторической застройки"], "pondpleasancepond": ["Ансамбли и Территории исторической застройки"], "champ": ["Ансамбли и Территории исторической застройки"], "monument": ["Пустое"], "Pierre": ["Пустое"], "statue": ["Пустое"], "clôture": ["Пустое"], "thermes": ["Пустое"], "tombeau": ["Пустое"], "obélisque": ["Пустое"], "sculpture": ["Пустое"], "autel": ["Пустое"], "stèle": ["Пустое"], "relief": ["Пустое"], "trône": ["Пустое"], "menhir": ["Пустое"], "cadran": ["Пустое"], "enceint": ["Пустое"], "statu": ["Пустое"], "Mire": ["Пустое"], "mémorial": ["Пустое"], "pyramid": ["Пустое"], "tombstone": ["Пустое"], "Valérien": ["Пустое"], "barrière": ["Пустое"], "ascenseur": ["Пустое"], "porte": ["Пустое"], "fontaine": ["Пустое"], "faïencerie": ["Пустое"], "colonn": ["Пустое"], "bouillon": ["Пустое"], "Lavatory": ["Пустое"], "muro": ["Пустое"], "regard": ["Пустое"], "arènes": ["Пустое"], "balustrade": ["Пустое"], "rampe": ["Пустое"], "Marchand": ["Пустое"], "trottoir": ["Пустое"], "grotte": ["Пустое"], "monticule": ["Пустое"], "tonnelle": ["Пустое"], "colombier": ["Пустое"], "mausoler": ["Пустое"], "kiosque de jardin": ["Пустое"], "écurie": ["Пустое"], "archéologique": ["Пустое"], "Carrière": ["Пустое"], "borne": ["Пустое"], "bonnet": ["Пустое"], "carrièr": ["Пустое"], "notredame": ["Пустое"]}
unusable_dict_types = {"académie": ["Здания"], "saintechapell": ["Здания"], "Gar": ["Здания"], "abbay": ["Здания"], "mosquer": ["Здания"], "palai": ["Здания"], "boutiqu": ["Здания"], "pharmaci": ["Здания"], "Institut": ["Здания"], "collège": ["Здания"], "lycer": ["Здания"], "laboratoir": ["Здания"], "sorbonne": ["Здания"], "restaurer": ["Здания"], "cafer": ["Здания"], "cirqu": ["Здания"], "Immeuble": ["Здания"], "muser": ["Здания"], "comédie": ["Здания"], "usin ": ["Здания"], "chasse": ["Здания"], "tristan": ["Здания"], "spr": ["Разное"], "amvap": ["Разное"], "Église": ["Здания"], "eglise": ["Здания"], "Monastère": ["Здания"], "Temple": ["Здания"], "Chapelle": ["Здания"], "prieuré": ["Здания"], "couvent": ["Здания"], "Cathédrale": ["Здания"], "Mosquée": ["Здания"], "Clocher": ["Здания"],"presbytère": ["Здания"], "synagogue": ["Здания"], "abbaye": ["Здания"], "basilique": ["Здания"], "collégiale": ["Здания"], "croixautel": ["Здания"], "cathédral": ["Здания"], "noviciat": ["Здания"], "Boutique": ["Здания"], "Marché": ["Здания"], "comptoir": ["Здания"], "Étal": ["Здания"], "Kiosque": ["Здания"], "Pavillon": ["Здания"], "Boulangerie": ["Здания"], "Pharmacie": ["Здания"], "poissonerie": ["Здания"], "crèmerie": ["Здания"], "boucherie": ["Здания"], "magasin": ["Здания"], "passage": ["Здания"], "débit": ["Здания"], "charcuterie": ["Здания"], "librairie": ["Здания"], "crémerieépicerie": ["Здания"], "boucheriecharcuterie": ["Здания"], "commerce": ["Здания"], "poissonnerie": ["Здания"], "Épicerie": ["Здания"], "epicerie": ["Здания"], "Courrier": ["Здания"], "Poste": ["Здания"], "téléphonique": ["Здания"], "Imprimerie": ["Здания"], "centrale téléphonique": ["Здания"], "bain": ["Здания"], "bains": ["Здания"], "lavoir": ["Здания"], "mobilier": ["Здания"], "Gymnase": ["Сооружения"], "Université": ["Здания"], "Lycée": ["Здания"], "Conservatoire": ["Здания"], "garderie": ["Здания"], "Jardin d'enfants": ["Здания"], "observatoir": ["Здания"], "Observatoire": ["Здания"], "laboratoire": ["Здания"], "faculté de médecine": ["Здания"], "ecole": ["Здания"], "faculté": ["Здания"], "groupe scolaire": ["Здания"], "scolaire": ["Здания"], "sarbonne": ["Здания"], "office": ["Здания"], "Bar": ["Здания"], "Brasserie": ["Здания"], "Café": ["Здания"], "Restaurant": ["Здания"], "Salle à manger": ["Здания"], "Taverne": ["Здания"],"Réfectoire": ["Здания"], "clownbar": ["Здания"], "boulangeriepâtisserie": ["Здания"], "boulangeriepâtisserieconfiserie": ["Здания"], "cafe": ["Здания"], "cafébar": ["Здания"], "barrestaurant": ["Здания"], "pâtisserie": ["Здания"], "confiserie": ["Здания"], "coffee house": ["Здания"], "crémerie": ["Здания"], "Cinéma": ["Здания"], "Galerie": ["Здания"], "Théâtre": ["Здания"], "Centre culturel": ["Здания"], "Maison de la culture": ["Здания"], "cinémer": ["Здания"], "Salle de concert": ["Здания"], "Club": ["Здания"], "cabaret": ["Здания"], "casino": ["Здания"], "caféconcert": ["Здания"], "Salle": ["Здания"], "Cercle": ["Здания"], "Arène": ["Здания"], "Musée": ["Здания"], "Archive": ["Здания"], "Bibliothèque": ["Здания"], "bibliothèqu": ["Здания"], "Hôtel": ["Здания"], "chambre": ["Здания"], "carmel": ["Здания"], "Ministère": ["Здания"], "Palais": ["Здания"], "Service": ["Здания"], "Siège": ["Здания"], "caisse": ["Здания"], "préfecture": ["Здания"], "tribunal": ["Здания"], "mairie": ["Здания"], "palace": ["Здания"], "hôtel de ville": ["Здания"], "Fondation": ["Здания"], "résidence": ["Здания"], "demeure": ["Здания"], "maison": ["Здания"], "ensemble": ["Здания"], "manoir": ["Здания"], "château": ["Здания"], "datcha": ["Здания"], "aile": ["Здания"], "villa": ["Здания"], "cour": ["Здания"], "cabane": ["Здания"], "domaine": ["Здания"], "viller": ["Здания"], "ferme": ["Здания"], "maisonatelier": ["Здания"], "bateau": ["Здания"], "Folie": ["Здания"], "logement": ["Здания"], "propriéter": ["Здания"], "propriété": ["Здания"], "chateau": ["Здания"], "chalet": ["Здания"], "foyer": ["Здания"], "logis seigneurial": ["Здания"], "dépendance": ["Здания"], "Hôpital": ["Здания"], "Sanatorium": ["Здания"], "hopital": ["Здания"], "Port": ["Здания"], "Plate-forme": ["Здания"], "Gare": ["Здания"], "Station": ["Сооружения"], "aérogare": ["Здания"], "aéroport": ["Здания"], "ceinture": ["Здания"], "Usine": ["Здания"], "Production": ["Здания"], "Manufacture": ["Здания"], "Microbrasserie": ["Здания"], "fabrique": ["Здания"], "porcelainerie": ["Здания"], "horlogerie": ["Здания"], "Banque": ["Здания"], "Bourse": ["Здания"], "Bours": ["Здания"], "Forteresse": ["Здания"], "Tor": ["Здания"], "Prison": ["Здания"], "Caserne": ["Здания"], "citérefuge": ["Здания"], "Entrepôt": ["Здания"], "dépôt": ["Здания"], "grange": ["Здания"], "hangar": ["Здания"], "Hippodrome": ["Сооружения"], "piscine": ["Сооружения"], "stade": ["Сооружения"], "jeu": ["Сооружения"], "orphelinat": ["Здания"], "hospic": ["Здания"], "hospice": ["Здания"], "asile": ["Здания"], "Atelier": ["Здания"], "Studio": ["Здания"], "Bureau": ["Здания"], "appartement": ["Здания"], "chemin de fer": ["Сооружения"], "tunnel": ["Сооружения"], "estacade": ["Сооружения"], "pont": ["Сооружения"], "jetée": ["Сооружения"], "viaduc": ["Сооружения"], "pontlever": ["Сооружения"], "pontroyal": ["Сооружения"], "pontneuf": ["Сооружения"], "passerell": ["Сооружения"], "quai": ["Сооружения"], "métropolitain": ["Сооружения"], "tour": ["Сооружения"], "arc": ["Сооружения"], "guérite": ["Сооружения"], "canal": ["Сооружения"], "amphithéâtre": ["Сооружения"], "sousstation": ["Сооружения"], "aqueduc": ["Сооружения"], "moulin": ["Сооружения"], "belleville": ["Сооружения"], "chaudron": ["Сооружения"], "bastion": ["Сооружения"], "donjon": ["Сооружения"], "bernage": ["Сооружения"], "souffleri": ["Сооружения"], "fort": ["Сооружения"], "douve": ["Сооружения"], "Bunker": ["Сооружения"], "cimitière": ["Сады и парки"], "parc": ["Сады и парки"], "jardin": ["Сады и парки"], "bois": ["Сады и парки"], "cimetière": ["Сады и парки"], "roseraie": ["Сады и парки"], "réserve": ["Городской ландшафт"], "champ de bataille": ["Городской ландшафт"], "paysage": ["Городской ландшафт"], "site classé": ["Городской ландшафт"], "site": ["Городской ландшафт"], "site inscrit": ["Городской ландшафт"], "Plateforme": ["Cооружения"], "site patrimonial remarquable": ["Городской ландшафт"], "plan de sauvegarde et de mise en valeur": ["Городской ландшафт"], "Square": ["Городской ландшафт"], "allée": ["Городской ландшафт"], "cité": ["Городской ландшафт"], "ilôt": ["Городской ландшафт"], "Place": ["Городской ландшафт"], "pondpleasancepond": ["Городской ландшафт"], "champ": ["Городской ландшафт"], "monument": ["Монумент / памятник"], "Pierre": ["Монумент / памятник"], "statue": ["Монумент / памятник"], "clôture": ["Монумент / памятник"], "thermes": ["Монумент / памятник"], "tombeau": ["Монумент / памятник"], "obélisque": ["Монумент / памятник"], "sculpture": ["Монумент / памятник"], "autel": ["Монумент / памятник"], "stèle": ["Монумент / памятник"], "relief": ["Монумент / памятник"], "trône": ["Монумент / памятник"], "menhir": ["Монумент / памятник"], "cadran": ["Монумент / памятник"], "enceint": ["Монумент / памятник"], "statu": ["Монумент / памятник"], "Mire": ["Монумент / памятник"], "mémorial": ["Монумент / памятник"], "pyramid": ["Монумент / памятник"], "tombstone": ["Монумент / памятник"], "Valérien": ["Монумент / памятник"], "barrière": ["Архитектурный элемент"], "ascenseur": ["Архитектурный элемент"], "porte": ["Архитектурный элемент"], "fontaine": ["Архитектурный элемент"], "faïencerie": ["Архитектурный элемент"], "colonn": ["Архитектурный элемент"], "bouillon": ["Архитектурный элемент"], "Lavatory": ["Архитектурный элемент"], "muro": ["Архитектурный элемент"], "regard": ["Архитектурный элемент"], "arènes": ["Архитектурный элемент"], "balustrade": ["Архитектурный элемент"], "rampe": ["Разное"], "Marchand": ["Разное"], "trottoir": ["Разное"], "grotte": ["Разное"], "monticule": ["Разное"], "tonnelle": ["Разное"], "colombier": ["Разное"], "mausoler": ["Разное"], "kiosque de jardin": ["Разное"], "écurie": ["Разное"], "archéologique": ["Археология"], "Carrière": ["Археология"], "borne": ["Археология"], "bonnet": ["Археология"], "carrièr": ["Археология"], "notredame": ["Археология"]}
data = pd.read_excel(r'D:\Dev\Pycharm projects\okn\paris-merimee.xlsx')
df = pd.DataFrame(data, columns= ['Appellation courante'])

def update_dict(old_dict: dict):
    new_dict = {}

    for key in old_dict:
        new_key = key.lower()
        new_dict[new_key] = old_dict[key]

    return new_dict


dict_functions = update_dict(unusable_dict_functions)
dict_types = update_dict(unusable_dict_types)


df['alt_name'] = ''
df['dict_keys'] = ''
df['results_functions'] = ''
df['nlp_list'] = ''
df['results_types'] = ''

for index, row in df.iterrows():
    row['alt_name'] = str(row['Appellation courante'])
    row['alt_name'] = row['alt_name'].lower()
    row['alt_name'] = re.sub(r'[^a-zA-ZàâäèéêëîïôœùûüÿçÀÂÄÈÉÊËÎÏÔŒÙÛÜŸÇ ]', '', row['alt_name'])
    row['dict_keys'] = []
    row['results_functions'] = []
    row['results_types'] = []

    row['nlp_list'] = []
    text = row['alt_name']
    doc = nlp(text)
    for token in doc:
        if token.pos_ in ('NOUN', 'PROPN', 'ADV', 'ADJ', 'VERB') and len(token.lemma_) >= 2:
            row['nlp_list'].append(token.lemma_)

    for key in row['nlp_list']:
        if key in dict_functions:
            row['results_functions'].extend(dict_functions[key])
        if key in dict_types:
            row['results_types'].extend(dict_types[key])

    row['results_functions'] = list(set(row['results_functions']))
    row['results_types'] = list(set(row['results_types']))

    if not row['results_functions']:
        row['results_functions'] = ['None']
    if not row['results_types']:
        row['results_types'] = ['None']

df.to_excel(r'D:\Dev\Pycharm projects\okn\paris-merimee-output.xlsx', sheet_name='Sheet1', index = False)



